<!DOCTYPE html>
<html lang="zh-CN" dir="ltr">
    <head><meta charset='utf-8'>
<meta name='viewport' content='width=device-width, initial-scale=1'><meta name='description' content='è¿™æœ¬ä¹¦ä¸»è¦è®²äº†ä½¿ç”¨golangåŸç”Ÿçš„net/httpåŒ…å¼€å‘Webåº”ç”¨ï¼Œåé¢ä¹Ÿå¼ºè°ƒäº†ä½¿ç”¨goroutineå’Œchannelå®ç°å¹¶å‘å¤„ç†ï¼Œæé«˜W'>
<title>è¯»ã€ŠGo Webç¼–ç¨‹ã€‹çš„ä¸€äº›ç¬”è®°</title>

<link rel='canonical' href='https://lizonglingo.github.io/p/%E8%AF%BBgo-web%E7%BC%96%E7%A8%8B%E7%9A%84%E4%B8%80%E4%BA%9B%E7%AC%94%E8%AE%B0/'>

<link rel="stylesheet" href="/scss/style.min.811a71d93d8df406268b1c66d015cd3f2252f454f25ac10a683e6f7b5ad9d92d.css"><meta property='og:title' content='è¯»ã€ŠGo Webç¼–ç¨‹ã€‹çš„ä¸€äº›ç¬”è®°'>
<meta property='og:description' content='è¿™æœ¬ä¹¦ä¸»è¦è®²äº†ä½¿ç”¨golangåŸç”Ÿçš„net/httpåŒ…å¼€å‘Webåº”ç”¨ï¼Œåé¢ä¹Ÿå¼ºè°ƒäº†ä½¿ç”¨goroutineå’Œchannelå®ç°å¹¶å‘å¤„ç†ï¼Œæé«˜W'>
<meta property='og:url' content='https://lizonglingo.github.io/p/%E8%AF%BBgo-web%E7%BC%96%E7%A8%8B%E7%9A%84%E4%B8%80%E4%BA%9B%E7%AC%94%E8%AE%B0/'>
<meta property='og:site_name' content='fmt.Println(&#34;Li Duo&#34;)'>
<meta property='og:type' content='article'><meta property='article:section' content='Post' /><meta property='article:tag' content='Golang' /><meta property='article:tag' content='Web' /><meta property='article:published_time' content='2021-10-15T08:19:54&#43;08:00'/><meta property='article:modified_time' content='2021-10-15T08:19:54&#43;08:00'/>
<meta name="twitter:title" content="è¯»ã€ŠGo Webç¼–ç¨‹ã€‹çš„ä¸€äº›ç¬”è®°">
<meta name="twitter:description" content="è¿™æœ¬ä¹¦ä¸»è¦è®²äº†ä½¿ç”¨golangåŸç”Ÿçš„net/httpåŒ…å¼€å‘Webåº”ç”¨ï¼Œåé¢ä¹Ÿå¼ºè°ƒäº†ä½¿ç”¨goroutineå’Œchannelå®ç°å¹¶å‘å¤„ç†ï¼Œæé«˜W">
    <link rel="shortcut icon" href="/favicon.ico" />

<script async src="https://www.googletagmanager.com/gtag/js?id=G-SPJXNM3WZ6"></script>
<script>
var doNotTrack = false;
if (!doNotTrack) {
	window.dataLayer = window.dataLayer || [];
	function gtag(){dataLayer.push(arguments);}
	gtag('js', new Date());
	gtag('config', 'G-SPJXNM3WZ6', { 'anonymize_ip': false });
}
</script>
<script>
    var _hmt = _hmt || [];
    (function() {
      var hm = document.createElement("script");
      hm.src = "https://hm.baidu.com/hm.js?b30bfbf01ac692ef3da66a21b24e6edb";
      var s = document.getElementsByTagName("script")[0]; 
      s.parentNode.insertBefore(hm, s);
    })();
    </script>
    
    </head>
    <body class="
    article-page
    ">
    <script>
        (function() {
            const colorSchemeKey = 'StackColorScheme';
            if(!localStorage.getItem(colorSchemeKey)){
                localStorage.setItem(colorSchemeKey, "auto");
            }
        })();
    </script><script>
    (function() {
        const colorSchemeKey = 'StackColorScheme';
        const colorSchemeItem = localStorage.getItem(colorSchemeKey);
        const supportDarkMode = window.matchMedia('(prefers-color-scheme: dark)').matches === true;

        if (colorSchemeItem == 'dark' || colorSchemeItem === 'auto' && supportDarkMode) {
            

            document.documentElement.dataset.scheme = 'dark';
        } else {
            document.documentElement.dataset.scheme = 'light';
        }
    })();
</script>
<div class="container main-container flex on-phone--column extended"><aside class="sidebar left-sidebar sticky ">
    <button class="hamburger hamburger--spin" type="button" id="toggle-menu" aria-label="åˆ‡æ¢èœå•">
        <span class="hamburger-box">
            <span class="hamburger-inner"></span>
        </span>
    </button>

    <header>
        
            
            <figure class="site-avatar">
                <a href="/">
                
                    <img src="https://picgo-lzl.oss-cn-beijing.aliyuncs.com/1634453613659.jpeg" width="300" height="300" class="site-logo" loading="lazy" alt="Avatar">
                
                </a>
                
                    <span class="emoji">ğŸ‘‹</span>
                
            </figure>
            
        
        
        <div class="site-meta">
            <h1 class="site-name"><a href="/">fmt.Println(&#34;Li Duo&#34;)</a></h1>
            <h2 class="site-description"></h2>
        </div>
    </header><ol class="social-menu">
            
                <li>
                    <a 
                        href='https://github.com/lizonglingo'
                        target="_blank"
                        title="GitHub"
                        rel="me"
                    >
                        
                        
                            <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-brand-github" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
  <path d="M9 19c-4.3 1.4 -4.3 -2.5 -6 -3m12 5v-3.5c0 -1 .1 -1.4 -.5 -2c2.8 -.3 5.5 -1.4 5.5 -6a4.6 4.6 0 0 0 -1.3 -3.2a4.2 4.2 0 0 0 -.1 -3.2s-1.1 -.3 -3.5 1.3a12.3 12.3 0 0 0 -6.2 0c-2.4 -1.6 -3.5 -1.3 -3.5 -1.3a4.2 4.2 0 0 0 -.1 3.2a4.6 4.6 0 0 0 -1.3 3.2c0 4.6 2.7 5.7 5.5 6c-.6 .6 -.6 1.2 -.5 2v3.5" />
</svg>



                        
                    </a>
                </li>
            
        </ol><ol class="menu" id="main-menu">
        
        
        
            
        
                
                <li >
                    <a href='/' >
                        
                        
                        
                            <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-home" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <polyline points="5 12 3 12 12 3 21 12 19 12" />
  <path d="M5 12v7a2 2 0 0 0 2 2h10a2 2 0 0 0 2 -2v-7" />
  <path d="M9 21v-6a2 2 0 0 1 2 -2h2a2 2 0 0 1 2 2v6" />
</svg>



                        
                        <span>ä¸»é¡µ</span>
                    </a>
                </li>
                
            
        
        
            
        
                
                <li >
                    <a href='/%E5%85%B3%E4%BA%8E/' >
                        
                        
                        
                            <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-user" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="12" cy="7" r="4" />
  <path d="M6 21v-2a4 4 0 0 1 4 -4h4a4 4 0 0 1 4 4v2" />
</svg>



                        
                        <span>å…³äº</span>
                    </a>
                </li>
                
            
        
        
            
        
                
                <li >
                    <a href='/archives/' >
                        
                        
                        
                            <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-archive" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <rect x="3" y="4" width="18" height="4" rx="2" />
  <path d="M5 8v10a2 2 0 0 0 2 2h10a2 2 0 0 0 2 -2v-10" />
  <line x1="10" y1="12" x2="14" y2="12" />
</svg>



                        
                        <span>å½’æ¡£</span>
                    </a>
                </li>
                
            
        
        
            
        
                
                <li >
                    <a href='/%E9%93%BE%E6%8E%A5/' >
                        
                        
                        
                            <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-link" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <path d="M10 14a3.5 3.5 0 0 0 5 0l4 -4a3.5 3.5 0 0 0 -5 -5l-.5 .5" />
  <path d="M14 10a3.5 3.5 0 0 0 -5 0l-4 4a3.5 3.5 0 0 0 5 5l.5 -.5" />
</svg>



                        
                        <span>é“¾æ¥</span>
                    </a>
                </li>
                
            
        
        
            
        
        

        <div class="menu-bottom-section">
            
            
                <li id="dark-mode-toggle">
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-toggle-left" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="8" cy="12" r="2" />
  <rect x="2" y="6" width="20" height="12" rx="6" />
</svg>



                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-toggle-right" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="16" cy="12" r="2" />
  <rect x="2" y="6" width="20" height="12" rx="6" />
</svg>



                    <span>æš—è‰²æ¨¡å¼</span>
                </li>
            
        </div>
    </ol>
</aside>

    <aside class="sidebar right-sidebar sticky">
        
            
                <form action="/search/" class="search-form widget" >
        <p>
            <label>æœç´¢</label>
            <input name="keyword" required placeholder="è¾“å…¥å…³é”®è¯..." />
        
            <button title="æœç´¢">
                <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-search" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="10" cy="10" r="7" />
  <line x1="21" y1="21" x2="15" y2="15" />
</svg>



            </button>
        </p>
    </form>
            
        
            
                
    <section class="widget archives">
        <div class="widget-icon">
            <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-hash" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <line x1="5" y1="9" x2="19" y2="9" />
  <line x1="5" y1="15" x2="19" y2="15" />
  <line x1="11" y1="4" x2="7" y2="20" />
  <line x1="17" y1="4" x2="13" y2="20" />
</svg>



        </div>
        <h2 class="widget-title section-title">ç›®å½•</h2>
        
        <div class="widget--toc">
            <nav id="TableOfContents">
  <ul>
    <li><a href="#1-goä¸webåº”ç”¨">1. Goä¸Webåº”ç”¨</a>
      <ul>
        <li><a href="#goçš„nethttp">Goçš„net/http</a></li>
        <li><a href="#å…³äºhttps">å…³äºHTTPS</a></li>
      </ul>
    </li>
    <li><a href="#2-ä¸€ä¸ªé€šç”¨çš„webåº”ç”¨">2. ä¸€ä¸ªé€šç”¨çš„Webåº”ç”¨</a>
      <ul>
        <li><a href="#ä½¿ç”¨cookieè¿›è¡Œè®¿é—®æ§åˆ¶">ä½¿ç”¨Cookieè¿›è¡Œè®¿é—®æ§åˆ¶</a></li>
      </ul>
    </li>
    <li><a href="#3-ä½¿ç”¨å¤„ç†å™¨å’Œå¤„ç†å™¨å‡½æ•°æ¥æ”¶è¯·æ±‚">3. ä½¿ç”¨å¤„ç†å™¨å’Œå¤„ç†å™¨å‡½æ•°æ¥æ”¶è¯·æ±‚</a>
      <ul>
        <li><a href="#å¤„ç†å™¨å’Œå¤„ç†å™¨å‡½æ•°">å¤„ç†å™¨å’Œå¤„ç†å™¨å‡½æ•°</a></li>
        <li><a href="#ä¸²è”å¤šä¸ªå¤„ç†å™¨å’Œå¤„ç†å™¨å‡½æ•°">ä¸²è”å¤šä¸ªå¤„ç†å™¨å’Œå¤„ç†å™¨å‡½æ•°</a></li>
        <li><a href="#servemuxå’Œdefaultservemux">ServeMuxå’ŒDefaultServeMux</a></li>
      </ul>
    </li>
    <li><a href="#4-è¯·æ±‚çš„å¤„ç†å’Œå“åº”">4. è¯·æ±‚çš„å¤„ç†å’Œå“åº”</a>
      <ul>
        <li><a href="#è¯·æ±‚å’Œå“åº”">è¯·æ±‚å’Œå“åº”</a></li>
        <li><a href="#ä»è¡¨å•ä¸­è·å–æ•°æ®">ä»è¡¨å•ä¸­è·å–æ•°æ®</a></li>
        <li><a href="#æœåŠ¡å™¨åšå‡ºå“åº”">æœåŠ¡å™¨åšå‡ºå“åº”</a></li>
        <li><a href="#cookie">Cookie</a></li>
      </ul>
    </li>
    <li><a href="#5-å†…å®¹å±•ç¤º">5. å†…å®¹å±•ç¤º</a>
      <ul>
        <li><a href="#æ¨¡æ¿çš„è¯­æ³•åˆ†æ">æ¨¡æ¿çš„è¯­æ³•åˆ†æ</a></li>
      </ul>
    </li>
    <li><a href="#6-å­˜å‚¨æ•°æ®">6. å­˜å‚¨æ•°æ®</a>
      <ul>
        <li><a href="#å†…å­˜å­˜å‚¨">å†…å­˜å­˜å‚¨</a></li>
        <li><a href="#csvcomma-separated-valueå­˜å‚¨">CSVï¼ˆcomma-separated valueï¼‰å­˜å‚¨</a></li>
        <li><a href="#encodinggob">encoding/gob</a></li>
        <li><a href="#æ•°æ®åº“ä¸å…³ç³»æ˜ å°„å™¨orm">æ•°æ®åº“ä¸å…³ç³»æ˜ å°„å™¨ORM</a></li>
      </ul>
    </li>
    <li><a href="#7-å‘æŒ¥goçš„å¹¶å‘ä¼˜åŠ¿">7. å‘æŒ¥Goçš„å¹¶å‘ä¼˜åŠ¿</a></li>
  </ul>
</nav>
        </div>
    </section>

            
        
    </aside>


            <main class="main full-width">
    <article class="main-article">
    <header class="article-header">

    <div class="article-details">
    
    <header class="article-category">
        
            <a href="/categories/golang/" >
                Golang
            </a>
        
            <a href="/categories/web/" >
                Web
            </a>
        
    </header>
    

    <div class="article-title-wrapper">
        <h2 class="article-title">
            <a href="/p/%E8%AF%BBgo-web%E7%BC%96%E7%A8%8B%E7%9A%84%E4%B8%80%E4%BA%9B%E7%AC%94%E8%AE%B0/">è¯»ã€ŠGo Webç¼–ç¨‹ã€‹çš„ä¸€äº›ç¬”è®°</a>
        </h2>
    
        
    </div>

    
    
    
    
    <footer class="article-time">
        
            <div>
                <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-calendar-time" width="56" height="56" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <path d="M11.795 21h-6.795a2 2 0 0 1 -2 -2v-12a2 2 0 0 1 2 -2h12a2 2 0 0 1 2 2v4" />
  <circle cx="18" cy="18" r="4" />
  <path d="M15 3v4" />
  <path d="M7 3v4" />
  <path d="M3 11h16" />
  <path d="M18 16.496v1.504l1 1" />
</svg>
                <time class="article-time--published">Oct 15, 2021</time>
            </div>
        

        
            <div>
                <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-clock" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="12" cy="12" r="9" />
  <polyline points="12 7 12 12 15 15" />
</svg>



                <time class="article-time--reading">
                    é˜…è¯»æ—¶é•¿: 15 åˆ†é’Ÿ
                </time>
            </div>
        
    </footer>
    

    
</div>

</header>

    <section class="article-content">
    
    
    <blockquote>
<p>è¿™æœ¬ä¹¦ä¸»è¦è®²äº†ä½¿ç”¨golangåŸç”Ÿçš„<code>net/http</code>åŒ…å¼€å‘Webåº”ç”¨ï¼Œåé¢ä¹Ÿå¼ºè°ƒäº†ä½¿ç”¨<code>goroutine</code>å’Œ<code>channel</code>å®ç°å¹¶å‘å¤„ç†ï¼Œæé«˜Webåº”ç”¨çš„æ€§èƒ½ã€‚æ˜¯ä¸€æœ¬æ¯”è¾ƒç³»ç»Ÿçš„ä»‹ç»Go Webå¼€å‘çš„ä¹¦ã€‚</p>
<p>æœ¬æ–‡æŒ‰ç…§å…¨ä¹¦è¡Œè¿›ç« èŠ‚è¿›è¡Œä¸€äº›è¦ç‚¹çš„è®°å½•ã€‚</p>
</blockquote>
<h2 id="1-goä¸webåº”ç”¨">1. Goä¸Webåº”ç”¨</h2>
<ol>
<li>å¤§è§„æ¨¡å¯æ‰©å±•çš„Webåº”ç”¨åº”å…·å¤‡ä»¥ä¸‹ç‰¹è´¨ï¼š
<ul>
<li>å¯æ‰©å±•ï¼šå‚ç›´æ‰©å±•ï¼ˆæå‡å•å°è®¾å¤‡çš„CPUæ•°é‡å’Œæ€§èƒ½ï¼‰ã€æ°´å¹³æ‰©å±•ï¼ˆå¢åŠ è®¡ç®—æœºçš„æ•°é‡æé«˜æ€§èƒ½ï¼‰ï¼Œgoçš„å¹¶å‘ç¼–ç¨‹çš„ç‰¹ç‚¹è®©å…¶åœ¨å‚ç›´æ‰©å±•ä¸Šæœ‰ä¼˜åŠ¿ã€‚</li>
<li>æ¨¡å—åŒ–ï¼šæ¥å£å®ç°åŠ¨æ€ç±»å‹åŒ¹é…ã€å‡½æ•°é—­åŒ…ç­‰ï¼Œæœ‰åŠ©äºæ¨¡å—åŒ–è®¾è®¡ï¼›goå¸¸ç”¨äºæ„å»ºå¾®æœåŠ¡ã€‚</li>
<li>å¯ç»´æŠ¤ï¼šè¯­æ³•ç®€æ´å¯è¯»ï¼Œå·¥å…·é“¾å¦‚<code>gotest</code>è¾ƒå®Œå¤‡ã€‚</li>
<li>é«˜æ€§èƒ½ï¼šç¼–è¯‘å‹é™æ€ä»£ç ï¼Œé€Ÿåº¦å¿«äºè§£é‡Šå‹è¯­è¨€ï¼Œå¹¶å‘ç¼–ç¨‹ä¹Ÿæœ‰åˆ©äºé«˜æ€§èƒ½ã€‚</li>
</ul>
</li>
<li>Webå·¥ä½œçš„åŸç†ï¼šä¸»è¦ç†è§£æœåŠ¡å™¨ä¸å®¢æˆ·ç«¯çš„é€šä¿¡åŸç†ï¼ŒåŒ…æ‹¬HTTPã€TCP/IPç­‰åè®®ã€‚è¿™é‡Œè¦æ³¨æ„ï¼ŒHTTPæ˜¯æ— çŠ¶æ€çš„ï¼Œæ‰€ä»¥å¼•å‡ºåé¢<code>cookie</code>å’Œ<code>session</code>çš„ä½¿ç”¨ï¼Œæ¥ä¿å­˜ç”¨æˆ·çŠ¶æ€ã€‚</li>
<li>HTTPè¯·æ±‚ï¼šè¦ç†Ÿæ‚‰è¯·æ±‚æŠ¥æ–‡ï¼Œå¦‚è¯·æ±‚å¤´ã€é¦–éƒ¨ã€æŠ¥æ–‡ä¸»ä½“ã€‚
<ul>
<li>è¯·æ±‚æ–¹æ³•ï¼šGETã€POSTã€DELETEã€HEADã€PUTç­‰ï¼Œåœ¨å…³äºRestful APIæ„å»ºæ˜¯ï¼Œè¿™äº›æ–¹æ³•æ˜¯è¦å¯¹åº”ä¸åŒçš„æœåŠ¡ã€‚</li>
<li>å®‰å…¨è¯·æ±‚æ–¹æ³•ï¼šå¦‚Getã€HEADä¸ä¼šå¯¹æœåŠ¡å™¨çš„çŠ¶æ€è¿›è¡Œä¿®æ”¹ï¼Œæ˜¯å®‰å…¨çš„ï¼›è€ŒPOSTã€PUTã€DELETEä¼šå¯¹æœåŠ¡å™¨çŠ¶æ€ä¿®æ”¹ï¼Œè¿™äº›æ–¹æ³•éƒ½æ˜¯ä¸å®‰å…¨çš„ã€‚</li>
<li>å¹‚ç­‰è¯·æ±‚æ–¹æ³•ï¼šå°±æ˜¯ä¸€ä¸ªHTTPæ–¹æ³•ä½¿ç”¨ç›¸åŒæ•°æ®è¿›è¡ŒäºŒæ¬¡è°ƒç”¨æ—¶ï¼Œä¸ä¼šå¯¹æœåŠ¡å™¨çš„çŠ¶æ€é€ æˆä»»ä½•æ”¹å˜ï¼Œé‚£è¿™ä¸ªæ–¹æ³•å°±æ˜¯å¹‚ç­‰çš„ã€‚æ‰€æœ‰å®‰å…¨è¯·æ±‚æ–¹æ³•éƒ½æ˜¯å¹‚ç­‰çš„ï¼ŒPUTå’ŒDELETEä¹Ÿæ˜¯å¹‚ç­‰çš„ã€‚</li>
<li>HTTPè¯·æ±‚é¦–éƒ¨ï¼šè®°å½•äº†ä¸è¯·æ±‚æœ¬èº«åŠå®¢æˆ·ç«¯æœ‰å…³çš„ä¿¡æ¯ï¼Œè®¸å¤šå­—æ®µå¦‚Acceptã€Cookieã€Content-Lengthã€Content-Typeã€User-Agentç­‰ï¼Œè¿™äº›éƒ½æ˜¯éœ€è¦ç†Ÿæ‚‰çš„ã€‚</li>
</ul>
</li>
<li>HTTPå“åº”ï¼šæ˜¯å¯¹HTTPè¯·æ±‚æŠ¥æ–‡çš„å“åº”ï¼ŒæŠ¥æ–‡åŒ…æ‹¬çŠ¶æ€è¡Œã€é›¶ä¸ªå’Œä»»æ„å“åº”é¦–éƒ¨ã€å¯é€‰æŠ¥æ–‡ä¸»ä½“ã€‚
<ul>
<li>å“åº”çŠ¶æ€ç ï¼šåœ¨çŠ¶æ€è¡Œä¸­ï¼Œæœ‰1XXã€2XXã€3XXã€4XXã€5XXäº”ç±»ï¼Œæœ‰ä¸åŒçš„å«ä¹‰ã€‚å¼€å‘ä¸­ï¼Œå¯¹è¯·æ±‚çš„æ­£å¸¸æˆ–è€…å¼‚å¸¸çš„å“åº”éƒ½æœ‰çŠ¶æ€ç æ˜¯ä¸€ä¸ªå¾ˆå¥½çš„ä¹ æƒ¯ã€‚</li>
<li>å“åº”é¦–éƒ¨ï¼šå¦‚Content-Lengthã€Content-Typeã€Set-Cookieç­‰ã€‚</li>
</ul>
</li>
<li>HTTP/2ï¼šHTTP/1æ˜¯çº¯æ–‡æœ¬æ–¹å¼ã€HTTP/2æ˜¯äºŒè¿›åˆ¶åè®®ï¼Œè¯­æ³•åˆ†ææ›´ä¸ºé«˜æ•ˆï¼Œåè®®æ›´åŠ ç´§å‡‘å’Œå¥å£®ã€‚HTTP 1.Xä¸€æ¬¡åªèƒ½å‘å•ä¸ªè¯·æ±‚ï¼Œè€ŒHTTP 2æ˜¯å®Œå…¨å¤šè·¯å¤ç”¨çš„ï¼Œå¤šä¸ªè¯·æ±‚å’Œå“åº”å¯ä»¥åœ¨åŒä¸€æ—¶é—´å†…ä½¿ç”¨åŒä¸€ä¸ªè¿æ¥ï¼Œæœ‰æ•ˆçš„æé«˜æ€§èƒ½ã€‚</li>
<li>Webåº”ç”¨é€šè¿‡HTTPåè®®ï¼Œä»¥HTTPè¯·æ±‚æŠ¥æ–‡çš„å½¢å¼è·å–å®¢æˆ·ç«¯è¾“å…¥-&gt;å¯¹è¯·æ±‚æŠ¥æ–‡è¿›è¡Œå¤„ç†åæ‰§è¡Œå¿…è¦çš„æ“ä½œ-&gt;ç”ŸæˆHTMLä»¥HTTPå“åº”æŠ¥æ–‡çš„å½¢å¼è¿”å›ç»™å®¢æˆ·ç«¯ã€‚ä¸ºäº†å®Œæˆè¿™äº›ä»»åŠ¡ï¼ŒWebåº”ç”¨å¯ä»¥è¢«åˆ†ä¸ºå¤„ç†å™¨Handlerå’Œæ¨¡æ¿å¼•æ“Template Engineä¸¤éƒ¨åˆ†ã€‚
<ul>
<li>å¤„ç†å™¨ï¼šå¤„ç†å™¨æ¥æ”¶è¯·æ±‚ï¼Œå¤„ç†ï¼Œè°ƒç”¨æ¨¡æ¿å¼•æ“å¡«å……æ•°æ®ã€‚åœ¨MVCæ¨¡å¼çœ‹æ¥å¤„ç†å™¨æ—¢æ˜¯controlleråˆæ˜¯modelã€‚</li>
<li>æ¨¡æ¿å¼•æ“ï¼šæ¥æ”¶å¤„ç†å™¨çš„æ•°æ®ï¼Œæ¸²æŸ“æˆHTMLè¿”å›ç»™å®¢æˆ·ç«¯ã€‚æœ‰é™æ€æ¨¡æ¿å’ŒåŠ¨æ€æ¨¡æ¿ä¸¤ç§ï¼Œé™æ€æ¨¡æ¿ç”¨å ä½ç¬¦æ›¿æ¢æˆç›¸åº”çš„æ•°æ®ç”ŸæˆHTMLï¼ŒåŠ¨æ€æ¨¡æ¿é™¤äº†ä½¿ç”¨å ä½ç¬¦ï¼Œè¿˜æœ‰ç¼–ç¨‹è¯­å¥ç»“æ„ï¼Œå¦‚æ¡ä»¶è¯­å¥ã€è¿­ä»£ã€å˜é‡ä¹‹ç±»çš„ã€‚</li>
</ul>
</li>
</ol>
<h3 id="goçš„nethttp">Goçš„net/http</h3>
<p><code>net/http</code>æ ‡å‡†åº“å¯ä»¥åˆ†ä¸ºå®¢æˆ·ç«¯å’ŒæœåŠ¡å™¨ä¸¤éƒ¨åˆ†ï¼Œæœ‰çš„ç»“æ„å’Œå‡½æ•°åªæ”¯æŒå®¢æˆ·ç«¯å’ŒæœåŠ¡å™¨ä¸­çš„ä¸€ä¸ªï¼Œæœ‰çš„åˆ™åŒæ—¶æ”¯æŒå®¢æˆ·ç«¯å’ŒæœåŠ¡å™¨ã€‚</p>
<p><img src="https://raw.githubusercontent.com/lizonglin313/MyPicGo/master/20211015112104.png"
	
	
	
	loading="lazy"
	
	
></p>
<p>ä¸€èˆ¬çš„æœ‰ä¸¤ç§æ–¹å¼é…ç½®WebæœåŠ¡å™¨ï¼š</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span><span style="color:#75715e">// æ–¹å¼ä¸€
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#a6e22e">http</span>.<span style="color:#a6e22e">ListenAndServe</span>(<span style="color:#e6db74">&#34;&#34;</span>, <span style="color:#66d9ef">nil</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">// æ–¹å¼äºŒ æ›´è¯¦ç»†çš„é…ç½®æœåŠ¡å™¨
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#a6e22e">server</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">http</span>.<span style="color:#a6e22e">Server</span>{
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">Addr</span>: 			<span style="color:#e6db74">&#34;127.0.0.1:8080&#34;</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">Handler</span>: 		<span style="color:#66d9ef">nil</span>,	<span style="color:#75715e">// ä½¿ç”¨çš„å¤„ç†å™¨
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    <span style="color:#a6e22e">ReadTimeout</span>:	<span style="color:#f92672">...</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">...</span>
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">server</span>.<span style="color:#a6e22e">ListenAndServe</span>()
</span></span></code></pre></div><h3 id="å…³äºhttps">å…³äºHTTPS</h3>
<p>ä½¿ç”¨HTTPSéœ€è¦è¯ä¹¦å’Œå¯†é’¥ï¼š</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span><span style="color:#a6e22e">server</span>.<span style="color:#a6e22e">ListenAndServeTLS</span>(<span style="color:#e6db74">&#34;cert.pem&#34;</span>, <span style="color:#e6db74">&#34;key.pem&#34;</span>)
</span></span></code></pre></div><p>å…¶ä¸­ï¼Œ<code>cert.pem</code>æ˜¯SSLè¯ä¹¦ï¼Œ<code>key.pem</code>æ˜¯æœåŠ¡å™¨çš„ç§é’¥ã€‚<strong>å®é™…çš„ç”Ÿäº§ç¯å¢ƒä¸­ä½¿ç”¨SSLè¯ä¹¦éœ€è¦é€šè¿‡VeriSignã€Thawteç­‰ä¸€äº›CAå–å¾—</strong>ã€‚é€šè¿‡Goçš„<code>crypto</code>åŒ…å¯ä»¥ç”Ÿæˆè¯ä¹¦ã€‚</p>
<h2 id="2-ä¸€ä¸ªé€šç”¨çš„webåº”ç”¨">2. ä¸€ä¸ªé€šç”¨çš„Webåº”ç”¨</h2>
<p><img src="https://raw.githubusercontent.com/lizonglin313/MyPicGo/master/20211015111703.png"
	
	
	
	loading="lazy"
	
	
></p>
<p>ä¸€ä¸ªé€šç”¨çš„Webåº”ç”¨ä»è®¾è®¡å¼€å§‹ï¼ŒåŒ…æ‹¬ä¸‹é¢ä¸€äº›æ–¹é¢ï¼š</p>
<ul>
<li>ä½¿ç”¨å¤šè·¯å¤ç”¨å™¨é…ç½®å¤„ç†å™¨ã€å¤„ç†å™¨å‡½æ•°</li>
<li>æ•°æ®æ¨¡å‹ï¼ŒåŒ…æ‹¬æ•°æ®ç»“æ„ã€å­˜å‚¨ç­‰</li>
<li>é™æ€æ–‡ä»¶å¦‚HTMLã€CSS</li>
<li>ä½¿ç”¨cookieå’Œsessionè¿›è¡Œè®¿é—®æ§åˆ¶</li>
<li>ä½¿ç”¨æ¨¡æ¿ç”ŸæˆHTMLå“åº”</li>
</ul>
<h3 id="ä½¿ç”¨cookieè¿›è¡Œè®¿é—®æ§åˆ¶">ä½¿ç”¨Cookieè¿›è¡Œè®¿é—®æ§åˆ¶</h3>
<p>ç”¨æˆ·ç™»å½•æˆåŠŸèº«ä»½ç»è¿‡éªŒè¯åï¼Œ<strong>æœåŠ¡å™¨ä¼šåœ¨æˆåŠŸçš„ç™»å½•è¯·æ±‚çš„å“åº”çš„é¦–éƒ¨ä¸­å†™å…¥ä¸€ä¸ªcookieï¼Œå®¢æˆ·ç«¯åœ¨æ¥æ”¶è¿™ä¸ªcookieåå°†å®ƒå†™å…¥å­˜å‚¨åˆ°æµè§ˆå™¨ä¸­</strong>ã€‚Goä¸­çš„<code>http.Cookie</code>ç”¨æ¥æ„å»ºcookieã€‚<strong>æ ¸å®ç”¨æˆ·èº«ä»½åï¼Œç¨‹åºåœ¨åç«¯åˆ›å»ºä¸€ä¸ªsessionï¼Œå­˜å‚¨åˆ°æ•°æ®åº“ä¸­ï¼Œsessionç»“æ„ä¸­çš„<code>uuid</code>å­—æ®µä½œä¸ºcookieçš„å€¼ï¼Œè¿”å›ç»™å®¢æˆ·ç«¯å­˜å‚¨åœ¨æµè§ˆå™¨é‡Œï¼Œä¹‹åç”Ÿå‘½å‘¨æœŸé‡Œæµè§ˆå™¨çš„è¯·æ±‚ä¼šå¸¦ç€cookieï¼Œå®Œæˆè®¿é—®æ§åˆ¶ã€‚</strong></p>
<p>å¯¹äºcookieçš„ç”Ÿå‘½å‘¨æœŸä¸€èˆ¬æœ‰ä¸¤ç±»ï¼š</p>
<p><strong>ä¼šè¯cookie</strong>ï¼šä¸è®¾ç½®ç‰¹å®šçš„è¿‡æœŸæ—¶é—´ï¼Œåœ¨æµè§ˆå™¨å…³é—­åè‡ªåŠ¨ç§»é™¤å¤±æ•ˆã€‚</p>
<p><strong>é€šè¿‡è®¾ç½®è¿‡æœŸæ—¶é—´çš„cookie</strong>ï¼šæ¯”å¦‚5minåè¿‡æœŸã€‚</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span><span style="color:#a6e22e">cookie</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">http</span>.<span style="color:#a6e22e">Cookie</span>{
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">Name</span>:		<span style="color:#e6db74">&#34;_cookie&#34;</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">Value</span>:		<span style="color:#a6e22e">session</span>.<span style="color:#a6e22e">Uuid</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">HttpOnly</span>:	<span style="color:#66d9ef">true</span>,
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">http</span>.<span style="color:#a6e22e">SetCookie</span>(<span style="color:#a6e22e">writer</span>, <span style="color:#f92672">&amp;</span><span style="color:#a6e22e">cookie</span>)	<span style="color:#75715e">// å†™åˆ°å“åº”é¦–éƒ¨
</span></span></span></code></pre></div><p><code>HttpOnly</code>å­—æ®µè¡¨ç¤ºè¯¥cookieåªèƒ½é€šè¿‡HTTP/HTTPSè®¿é—®ï¼Œæ— æ³•é€šè¿‡JavaScriptç­‰éHTTP APIè®¿é—®ã€‚</p>
<p>åœ¨åç»­å®¢æˆ·ç«¯å‘æ¥è¯·æ±‚åï¼ŒæœåŠ¡å™¨ä»Requestä¸­æ‹¿åˆ°cookieçš„valueï¼Œä¹Ÿå°±æ˜¯å­˜å‚¨åœ¨æ•°æ®åº“ä¸­sessionå¯¹è±¡çš„Uuidï¼Œè¿›è¡Œæ¯”å¯¹ï¼Œè¿›è€Œè¯†åˆ«è¯·æ±‚çš„å®¢æˆ·ç«¯èº«ä»½æ˜¯å¦åˆæ³•ã€‚</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span><span style="color:#75715e">// æ‹¿åˆ°cookieè¿›è¡Œè®¿é—®æ§åˆ¶å¤„ç†
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#a6e22e">cookie</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">r</span>.<span style="color:#a6e22e">Cookie</span>(<span style="color:#e6db74">&#34;_cookie&#34;</span>)
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">sess</span> = <span style="color:#a6e22e">data</span>.<span style="color:#a6e22e">Session</span>{<span style="color:#a6e22e">Uuid</span>: <span style="color:#a6e22e">cookie</span>.<span style="color:#a6e22e">Value</span>}
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">ok</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">sess</span>.<span style="color:#a6e22e">Check</span>()
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">if</span> <span style="color:#a6e22e">ok</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">...</span>
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><h2 id="3-ä½¿ç”¨å¤„ç†å™¨å’Œå¤„ç†å™¨å‡½æ•°æ¥æ”¶è¯·æ±‚">3. ä½¿ç”¨å¤„ç†å™¨å’Œå¤„ç†å™¨å‡½æ•°æ¥æ”¶è¯·æ±‚</h2>
<h3 id="å¤„ç†å™¨å’Œå¤„ç†å™¨å‡½æ•°">å¤„ç†å™¨å’Œå¤„ç†å™¨å‡½æ•°</h3>
<h4 id="å¤„ç†å™¨">å¤„ç†å™¨</h4>
<p>Goä¸­ï¼Œä¸€ä¸ªå¤„ç†å™¨å°±æ˜¯ä¸€ä¸ªæ‹¥æœ‰<code>ServeHTTP(http.ResponWriter, *http.Request)</code>æ–¹æ³•çš„æ¥å£ã€‚è€Œå¤šè·¯å¤ç”¨å™¨<code>DefaultServerMux</code>æ˜¯<code>ServeMux</code>çš„ä¸€ä¸ªå®ä¾‹ï¼Œåè€…ä¹Ÿå®ç°äº†<code>ServeHTTP</code>æ–¹æ³•ã€‚<code>DefaultServerMux</code>æ—¢æ˜¯<code>ServeMux</code>çš„å®ä¾‹ï¼Œä¹Ÿæ˜¯<code>Handler</code>ç»“æ„çš„å®ä¾‹ï¼Œå®ƒä¸ä»…æ˜¯ä¸€ä¸ªå¤šè·¯å¤ç”¨å™¨è¿˜æ˜¯ä¸€ä¸ªå¤„ç†å™¨ã€‚<strong>å®ƒè¦åšçš„äº‹æƒ…å°±æ˜¯æ ¹æ®è¯·æ±‚çš„URLé‡å®šå‘åˆ°ä¸åŒçš„å¤„ç†å™¨ä¸Š</strong>ã€‚</p>
<p>å½“ç„¶ï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥ç¼–å†™è‡ªå·±çš„å¤„ç†å™¨å»ä»£æ›¿é»˜è®¤çš„<code>DefaultServerMux</code>ã€‚æ›´å¤šçš„æ—¶å€™ï¼Œæˆ‘ä»¬ä¼šä½¿ç”¨å¤šä¸ªå¤„ç†å™¨å»å¤„ç†æŒ‡å®šçš„URLï¼Œæ‰€ä»¥å¸¸å¸¸ä½¿ç”¨æœåŠ¡å™¨é»˜è®¤çš„<code>DefaultServerMux</code>åšå¤šè·¯å¤ç”¨å™¨ï¼Œå°†ä¸åŒçš„å¤„ç†å™¨ä½¿ç”¨<code>http.Handle</code>ç»‘å®šåˆ°<code>DefaultServerMux</code>ã€‚<code>http.Handle</code><strong>å®é™…ä¸Šæ˜¯</strong><code>ServeMux</code>ç»“æ„çš„æ–¹æ³•ï¼š</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span><span style="color:#75715e">// å®šä¹‰ä¸€ä¸ªå¤„ç†å™¨
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#66d9ef">type</span> <span style="color:#a6e22e">HelloHandler</span> <span style="color:#66d9ef">struct</span>{}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">// å®ç° ServeHTTP æ¥å£
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#66d9ef">func</span> (<span style="color:#a6e22e">h</span> <span style="color:#f92672">*</span><span style="color:#a6e22e">HelloHandler</span>) <span style="color:#a6e22e">ServeHTTP</span>(<span style="color:#a6e22e">w</span> <span style="color:#a6e22e">http</span>.<span style="color:#a6e22e">ResponseWriter</span>, <span style="color:#a6e22e">r</span> <span style="color:#f92672">*</span><span style="color:#a6e22e">http</span>.<span style="color:#a6e22e">Request</span>) {
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">...</span>
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">// http.Handle ä¹Ÿåšå¤šè·¯å¤ç”¨å™¨çš„ç”¨é€”
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#a6e22e">http</span>.<span style="color:#a6e22e">Handle</span>(<span style="color:#e6db74">&#34;/hello&#34;</span>, <span style="color:#f92672">&amp;</span><span style="color:#a6e22e">hello</span>)	<span style="color:#75715e">// ä¼ å…¥ä¸€ä¸ªå¤„ç†å™¨å¤„ç†æ¥è‡ª /hello çš„è·¯ç”±
</span></span></span></code></pre></div><h4 id="å¤„ç†å™¨å‡½æ•°">å¤„ç†å™¨å‡½æ•°</h4>
<p><strong>å¤„ç†å™¨å‡½æ•°æ˜¯ä¸å¤„ç†å™¨æ‹¥æœ‰ç›¸åŒè¡Œä¸ºçš„å‡½æ•°ï¼Œä¸ServeHTTPæœ‰ç›¸åŒçš„ç­¾å</strong>ã€‚</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span><span style="color:#66d9ef">func</span> <span style="color:#a6e22e">hello</span>(<span style="color:#a6e22e">w</span> <span style="color:#a6e22e">http</span>.<span style="color:#a6e22e">ResponseWriter</span>, <span style="color:#a6e22e">r</span> <span style="color:#f92672">*</span><span style="color:#a6e22e">http</span>.<span style="color:#a6e22e">Request</span>) {
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">...</span>
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">http</span>.<span style="color:#a6e22e">HandleFunc</span>(<span style="color:#e6db74">&#34;/hello&#34;</span>, <span style="color:#a6e22e">hello</span>)
</span></span></code></pre></div><p>å®é™…ä¸Šï¼ŒGoçš„<code>HandlerFunc</code>å‡½æ•°ç±»å‹ï¼Œ<strong>æŠŠä¸€ä¸ªå¤„ç†å™¨å‡½æ•°éšå¼çš„è½¬æ¢æˆä¸€ä¸ªå¤„ç†å™¨</strong>ã€‚</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span><span style="color:#75715e">// æºç 
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">// å°†å¤„ç†å™¨å‡½æ•°ç»™é»˜è®¤çš„å¤šè·¯å¤ç”¨å¤„ç†å™¨
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#66d9ef">func</span> <span style="color:#a6e22e">HandleFunc</span>(<span style="color:#a6e22e">pattern</span> <span style="color:#66d9ef">string</span>, <span style="color:#a6e22e">handler</span> <span style="color:#66d9ef">func</span>(<span style="color:#a6e22e">ResponseWriter</span>, <span style="color:#f92672">*</span><span style="color:#a6e22e">Request</span>)) {
</span></span><span style="display:flex;"><span>	<span style="color:#a6e22e">DefaultServeMux</span>.<span style="color:#a6e22e">HandleFunc</span>(<span style="color:#a6e22e">pattern</span>, <span style="color:#a6e22e">handler</span>)
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">// è°ƒç”¨ å¤šè·¯å¤ç”¨å¤„ç†å™¨çš„ HandleFunc å¯¹è·¯ç”±ç»‘å®šå¤„ç†å™¨
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#66d9ef">func</span> (<span style="color:#a6e22e">mux</span> <span style="color:#f92672">*</span><span style="color:#a6e22e">ServeMux</span>) <span style="color:#a6e22e">HandleFunc</span>(<span style="color:#a6e22e">pattern</span> <span style="color:#66d9ef">string</span>, <span style="color:#a6e22e">handler</span> <span style="color:#66d9ef">func</span>(<span style="color:#a6e22e">ResponseWriter</span>, <span style="color:#f92672">*</span><span style="color:#a6e22e">Request</span>)) {
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">if</span> <span style="color:#a6e22e">handler</span> <span style="color:#f92672">==</span> <span style="color:#66d9ef">nil</span> {
</span></span><span style="display:flex;"><span>		panic(<span style="color:#e6db74">&#34;http: nil handler&#34;</span>)
</span></span><span style="display:flex;"><span>	}
</span></span><span style="display:flex;"><span>	<span style="color:#a6e22e">mux</span>.<span style="color:#a6e22e">Handle</span>(<span style="color:#a6e22e">pattern</span>, <span style="color:#a6e22e">HandlerFunc</span>(<span style="color:#a6e22e">handler</span>))
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">// mux.Handle(pattern, HandlerFunc(handler)) é‡Œé¢çš„ HandlerFunc() å®ç°äº† ServeHTTP
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#66d9ef">type</span> <span style="color:#a6e22e">HandlerFunc</span> <span style="color:#66d9ef">func</span>(<span style="color:#a6e22e">ResponseWriter</span>, <span style="color:#f92672">*</span><span style="color:#a6e22e">Request</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">// ServeHTTP calls f(w, r).
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#66d9ef">func</span> (<span style="color:#a6e22e">f</span> <span style="color:#a6e22e">HandlerFunc</span>) <span style="color:#a6e22e">ServeHTTP</span>(<span style="color:#a6e22e">w</span> <span style="color:#a6e22e">ResponseWriter</span>, <span style="color:#a6e22e">r</span> <span style="color:#f92672">*</span><span style="color:#a6e22e">Request</span>) {
</span></span><span style="display:flex;"><span>	<span style="color:#a6e22e">f</span>(<span style="color:#a6e22e">w</span>, <span style="color:#a6e22e">r</span>)
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><h3 id="ä¸²è”å¤šä¸ªå¤„ç†å™¨å’Œå¤„ç†å™¨å‡½æ•°">ä¸²è”å¤šä¸ªå¤„ç†å™¨å’Œå¤„ç†å™¨å‡½æ•°</h3>
<p>å¸¸è§çš„Webåœ¨çœŸæ­£å¤„ç†æ•°æ®æ—¶ï¼Œå¾€å¾€éœ€è¦åšä¸€äº›å…¶ä»–å·¥ä½œï¼Œå¦‚ï¼š<strong>æ—¥å¿—è®°å½•</strong>ã€<strong>å®‰å…¨æ£€æŸ¥</strong>ã€<strong>é”™è¯¯å¤„ç†</strong>ç­‰ã€‚<strong>æœ‰äº›æ—¶å€™éœ€è¦åœ¨å¤„ç†ä¸šåŠ¡çš„å¤„ç†å™¨å‰é¢ä¸²è”ä¸Šå…¶ä»–çš„å¤„ç†å™¨</strong>ï¼Œåˆå«åš<strong>ç®¡é“å¤„ç†</strong>ã€‚<strong>å¾—ç›ŠäºGoçš„åŒ¿åå‡½æ•°</strong>ã€<strong>é—­åŒ…</strong>è¿™äº›ç‰¹æ€§ï¼Œå¯ä»¥å¾ˆå¥½çš„å°†å¤„ç†å™¨ä¸²è”èµ·æ¥ã€‚</p>
<h4 id="ä¸²è”å¤šä¸ªå¤„ç†å™¨å‡½æ•°">ä¸²è”å¤šä¸ªå¤„ç†å™¨å‡½æ•°</h4>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span><span style="color:#75715e">// ä¸²è”å¤šä¸ªå¤„ç†å™¨å‡½æ•°
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">func</span> <span style="color:#a6e22e">hello</span>(<span style="color:#a6e22e">w</span> <span style="color:#a6e22e">http</span>.<span style="color:#a6e22e">ResponseWriter</span>, <span style="color:#a6e22e">r</span> <span style="color:#f92672">*</span><span style="color:#a6e22e">http</span>.<span style="color:#a6e22e">Request</span>) {
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">fmt</span>.<span style="color:#a6e22e">Fprintf</span>(<span style="color:#a6e22e">w</span>, <span style="color:#e6db74">&#34;hello&#34;</span>)
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">// åœ¨å¤„ç†helloå‰ä¸²è”ä¸€ä¸ªè®°å½•æ—¥å¿—çš„å¤„ç†å™¨
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#66d9ef">func</span> <span style="color:#a6e22e">log</span>(<span style="color:#a6e22e">h</span> <span style="color:#a6e22e">http</span>.<span style="color:#a6e22e">HandlerFunc</span>) <span style="color:#a6e22e">http</span>.<span style="color:#a6e22e">HandlerFunc</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> <span style="color:#66d9ef">func</span> (<span style="color:#a6e22e">w</span> <span style="color:#a6e22e">http</span>.<span style="color:#a6e22e">ResponseWriter</span>, <span style="color:#a6e22e">r</span> <span style="color:#f92672">*</span><span style="color:#a6e22e">http</span>.<span style="color:#a6e22e">Request</span>) {
</span></span><span style="display:flex;"><span>        <span style="color:#75715e">// å¤„ç†æ—¥å¿—
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>        <span style="color:#f92672">...</span>
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">h</span>(<span style="color:#a6e22e">w</span>, <span style="color:#a6e22e">r</span>)
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">// åœ¨å¤„ç†æ—¥å¿—ä¹‹å‰å†ä¸²è”ä¸€ä¸ªéªŒè¯ç”¨æˆ·èº«ä»½çš„å¤„ç†å™¨
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#66d9ef">func</span> <span style="color:#a6e22e">authentication</span>(<span style="color:#a6e22e">h</span> <span style="color:#a6e22e">http</span>.<span style="color:#a6e22e">HandlerFunc</span>) <span style="color:#a6e22e">http</span>.<span style="color:#a6e22e">HandlerFunc</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> <span style="color:#66d9ef">func</span> (<span style="color:#a6e22e">w</span> <span style="color:#a6e22e">http</span>.<span style="color:#a6e22e">ResponseWriter</span>, <span style="color:#a6e22e">r</span> <span style="color:#f92672">*</span><span style="color:#a6e22e">http</span>.<span style="color:#a6e22e">Request</span>) {
</span></span><span style="display:flex;"><span>        <span style="color:#75715e">// é‰´æƒ
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>        <span style="color:#f92672">...</span>
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">h</span>(<span style="color:#a6e22e">w</span>, <span style="color:#a6e22e">r</span>)
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">// main
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#66d9ef">func</span> <span style="color:#a6e22e">main</span>() {
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">...</span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">http</span>.<span style="color:#a6e22e">HandleFunc</span>(<span style="color:#e6db74">&#34;/hello&#34;</span>, <span style="color:#a6e22e">authentication</span>(<span style="color:#a6e22e">log</span>(<span style="color:#a6e22e">hello</span>)))
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">...</span>
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><h4 id="ä¸²è”å¤„ç†å™¨">ä¸²è”å¤„ç†å™¨</h4>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span><span style="color:#66d9ef">type</span> <span style="color:#a6e22e">HelloHandler</span> <span style="color:#66d9ef">struct</span>{}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">func</span> (<span style="color:#a6e22e">h</span> <span style="color:#a6e22e">HelloHandler</span>) <span style="color:#a6e22e">ServeHTTP</span>(<span style="color:#a6e22e">w</span> <span style="color:#a6e22e">http</span>.<span style="color:#a6e22e">ResponseWriter</span>, <span style="color:#a6e22e">r</span> <span style="color:#f92672">*</span><span style="color:#a6e22e">http</span>.<span style="color:#a6e22e">Request</span>) {
</span></span><span style="display:flex;"><span>	<span style="color:#a6e22e">fmt</span>.<span style="color:#a6e22e">Fprintf</span>(<span style="color:#a6e22e">w</span>, <span style="color:#e6db74">&#34;hello!&#34;</span>)
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">func</span> <span style="color:#a6e22e">log</span>(<span style="color:#a6e22e">h</span> <span style="color:#a6e22e">http</span>.<span style="color:#a6e22e">Handler</span>) <span style="color:#a6e22e">http</span>.<span style="color:#a6e22e">Handler</span> {
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">return</span> <span style="color:#a6e22e">http</span>.<span style="color:#a6e22e">HandlerFunc</span>(<span style="color:#66d9ef">func</span>(<span style="color:#a6e22e">w</span> <span style="color:#a6e22e">http</span>.<span style="color:#a6e22e">ResponseWriter</span>, <span style="color:#a6e22e">r</span> <span style="color:#f92672">*</span><span style="color:#a6e22e">http</span>.<span style="color:#a6e22e">Request</span>) {
</span></span><span style="display:flex;"><span>		<span style="color:#a6e22e">fmt</span>.<span style="color:#a6e22e">Printf</span>(<span style="color:#e6db74">&#34;Handler called - %T\n&#34;</span>, <span style="color:#a6e22e">h</span>)
</span></span><span style="display:flex;"><span>		<span style="color:#75715e">// å¤„ç†å™¨ç›´æ¥æ˜¾ç¤ºè°ƒç”¨ServeHTTP
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>        <span style="color:#a6e22e">h</span>.<span style="color:#a6e22e">ServeHTTP</span>(<span style="color:#a6e22e">w</span>, <span style="color:#a6e22e">r</span>)
</span></span><span style="display:flex;"><span>	})
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">func</span> <span style="color:#a6e22e">authentication</span>(<span style="color:#a6e22e">h</span> <span style="color:#a6e22e">http</span>.<span style="color:#a6e22e">Handler</span>) <span style="color:#a6e22e">http</span>.<span style="color:#a6e22e">Handler</span> {
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">return</span> <span style="color:#a6e22e">http</span>.<span style="color:#a6e22e">HandlerFunc</span>(<span style="color:#66d9ef">func</span>(<span style="color:#a6e22e">w</span> <span style="color:#a6e22e">http</span>.<span style="color:#a6e22e">ResponseWriter</span>, <span style="color:#a6e22e">r</span> <span style="color:#f92672">*</span><span style="color:#a6e22e">http</span>.<span style="color:#a6e22e">Request</span>) {
</span></span><span style="display:flex;"><span>		<span style="color:#a6e22e">fmt</span>.<span style="color:#a6e22e">Println</span>(<span style="color:#e6db74">&#34;Do some protect...&#34;</span>)
</span></span><span style="display:flex;"><span>		<span style="color:#a6e22e">h</span>.<span style="color:#a6e22e">ServeHTTP</span>(<span style="color:#a6e22e">w</span>, <span style="color:#a6e22e">r</span>)
</span></span><span style="display:flex;"><span>	})
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">func</span> <span style="color:#a6e22e">main</span>() {
</span></span><span style="display:flex;"><span>	<span style="color:#f92672">...</span>
</span></span><span style="display:flex;"><span>	<span style="color:#a6e22e">http</span>.<span style="color:#a6e22e">Handle</span>(<span style="color:#e6db74">&#34;/hello&#34;</span>, <span style="color:#a6e22e">authentication</span>(<span style="color:#a6e22e">log</span>(<span style="color:#a6e22e">hello</span>)))
</span></span><span style="display:flex;"><span>	<span style="color:#f92672">...</span>
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>ä¸ä¸²è”å¤„ç†å™¨å‡½æ•°ä¸åŒçš„æ˜¯ï¼Œ<strong>ä¸²è”å¤„ç†å™¨éœ€è¦å°†åŒ¿åå‡½æ•°è¿”å›çš„å‡½æ•°æ˜¾å¼çš„ä½¿ç”¨</strong><code>http.HandlerFunc</code>è½¬æ¢æˆ<code>http.Handler</code>ã€‚åœ¨<code>main</code>ä¸­ä½¿ç”¨çš„ä¹Ÿæ˜¯<code>http.Handle()</code>è€Œä¸æ˜¯<code>http.HandleFunc()</code>äº†ã€‚</p>
<h3 id="servemuxå’Œdefaultservemux">ServeMuxå’ŒDefaultServeMux</h3>
<p><img src="https://raw.githubusercontent.com/lizonglin313/MyPicGo/master/20211015155042.png"
	
	
	
	loading="lazy"
	
	
></p>
<p>ServeMuxå°†URLæ˜ å°„åˆ°å“åº”çš„å¤„ç†å™¨ã€‚å®ƒä¹Ÿå®ç°äº†<code>ServeHTTP</code>æ–¹æ³•ã€‚</p>
<p><img src="https://raw.githubusercontent.com/lizonglin313/MyPicGo/master/20211015155320.png"
	
	
	
	loading="lazy"
	
	
></p>
<p>è€ŒDefaultServeMuxæ˜¯ServeMuxçš„ä¸€ä¸ªå®ä¾‹ã€‚å¼€å‘ä¸­æ²¡æœ‰æŒ‡å®šå¤„ç†å™¨æ˜¯ï¼ŒGoçš„æœåŠ¡å™¨å°±ä¼šç”¨å®ƒä½œä¸ºé»˜è®¤å®ä¾‹ã€‚</p>
<h4 id="æœ€å°æƒŠè®¶åŸåˆ™">æœ€å°æƒŠè®¶åŸåˆ™</h4>
<p>ä»ä¸Šå›¾ï¼Œå‡è®¾æœ‰ï¼š</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span><span style="color:#a6e22e">http</span>.<span style="color:#a6e22e">Handle</span>(<span style="color:#e6db74">&#34;/hello&#34;</span>, <span style="color:#f92672">&amp;</span><span style="color:#a6e22e">helloHandler</span>)
</span></span></code></pre></div><p>è¯·æ±‚çš„URLä¸º<code>/hello</code>ï¼Œå¤šè·¯å¤ç”¨å™¨ä¼šåˆ†å‘åˆ°<code>helloHandler</code>å¤„ç†ï¼Œè‹¥ä¸º<code>/hello/other</code>å‘¢ï¼Ÿ</p>
<p>ç­”æ¡ˆä¹Ÿæ˜¯ä¸€æ ·ï¼š<code>helloHandler</code>ã€‚å°±ç±»ä¼¼äºæœ€é•¿å‰ç¼€åŒ¹é…è§„åˆ™ã€‚</p>
<p>ä½†æ˜¯ï¼Œå¦‚æœæ”¹æˆï¼š</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span><span style="color:#a6e22e">http</span>.<span style="color:#a6e22e">Handle</span>(<span style="color:#e6db74">&#34;/hello/&#34;</span>, <span style="color:#f92672">&amp;</span><span style="color:#a6e22e">helloHandler</span>)
</span></span></code></pre></div><p>åŒ¹é…çš„è·¯ç”±åé¢ä¹Ÿæœ‰<code>/</code>ï¼Œé‚£ä¹ˆåªä¼šä¸å®Œå…¨ç›¸åŒçš„<code>/hello/</code>åŒ¹é…ï¼Œè€Œ<code>/hello/other</code>å°±ä¼šåŒ¹é…ä¸åˆ°ï¼Œè¿”å›é”™è¯¯ã€‚</p>
<h4 id="å…¶ä»–çš„å¤„ç†å™¨">å…¶ä»–çš„å¤„ç†å™¨</h4>
<p>é™¤<code>net/http</code>åŒ…å¤–ï¼Œè¿˜æœ‰å¦‚<code>HttpRouter</code>å®ç°çš„æœåŠ¡å™¨ï¼Œå¯ä»¥ä½¿ç”¨å˜é‡å®ç°URLæ¨¡å¼åŒ¹é…ï¼Œæœ‰æ›´å¤šä¸°å¯Œçš„åŠŸèƒ½ã€‚</p>
<h2 id="4-è¯·æ±‚çš„å¤„ç†å’Œå“åº”">4. è¯·æ±‚çš„å¤„ç†å’Œå“åº”</h2>
<h3 id="è¯·æ±‚å’Œå“åº”">è¯·æ±‚å’Œå“åº”</h3>
<h4 id="requestç»“æ„">Requestç»“æ„</h4>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span><span style="color:#66d9ef">type</span> <span style="color:#a6e22e">Request</span> <span style="color:#66d9ef">struct</span> {
</span></span><span style="display:flex;"><span>	<span style="color:#a6e22e">Method</span> <span style="color:#66d9ef">string</span>
</span></span><span style="display:flex;"><span>	<span style="color:#a6e22e">URL</span> <span style="color:#f92672">*</span><span style="color:#a6e22e">url</span>.<span style="color:#a6e22e">URL</span>
</span></span><span style="display:flex;"><span>	<span style="color:#a6e22e">Header</span> <span style="color:#a6e22e">Header</span>
</span></span><span style="display:flex;"><span>	<span style="color:#a6e22e">Body</span> <span style="color:#a6e22e">io</span>.<span style="color:#a6e22e">ReadCloser</span>
</span></span><span style="display:flex;"><span>	<span style="color:#a6e22e">GetBody</span> <span style="color:#66d9ef">func</span>() (<span style="color:#a6e22e">io</span>.<span style="color:#a6e22e">ReadCloser</span>, <span style="color:#66d9ef">error</span>)	<span style="color:#75715e">// å®ä¾‹åŒ–æ—¶é€šè¿‡åŒ¿åå‡½æ•°å®ç° GetBody
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>	<span style="color:#a6e22e">ContentLength</span> <span style="color:#66d9ef">int64</span>
</span></span><span style="display:flex;"><span>	<span style="color:#a6e22e">TransferEncoding</span> []<span style="color:#66d9ef">string</span>
</span></span><span style="display:flex;"><span>	<span style="color:#a6e22e">Close</span> <span style="color:#66d9ef">bool</span>
</span></span><span style="display:flex;"><span>	<span style="color:#a6e22e">Host</span> <span style="color:#66d9ef">string</span>
</span></span><span style="display:flex;"><span>	<span style="color:#a6e22e">Form</span> <span style="color:#a6e22e">url</span>.<span style="color:#a6e22e">Values</span>
</span></span><span style="display:flex;"><span>	<span style="color:#a6e22e">PostForm</span> <span style="color:#a6e22e">url</span>.<span style="color:#a6e22e">Values</span>
</span></span><span style="display:flex;"><span>	<span style="color:#a6e22e">MultipartForm</span> <span style="color:#f92672">*</span><span style="color:#a6e22e">multipart</span>.<span style="color:#a6e22e">Form</span>
</span></span><span style="display:flex;"><span>	<span style="color:#a6e22e">TLS</span> <span style="color:#f92672">*</span><span style="color:#a6e22e">tls</span>.<span style="color:#a6e22e">ConnectionState</span>
</span></span><span style="display:flex;"><span>	<span style="color:#a6e22e">Response</span> <span style="color:#f92672">*</span><span style="color:#a6e22e">Response</span>
</span></span><span style="display:flex;"><span>	<span style="color:#a6e22e">ctx</span> <span style="color:#a6e22e">context</span>.<span style="color:#a6e22e">Context</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">...</span>
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><h4 id="urlç»“æ„">URLç»“æ„</h4>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span><span style="color:#66d9ef">type</span> <span style="color:#a6e22e">URL</span> <span style="color:#66d9ef">struct</span> {
</span></span><span style="display:flex;"><span>	<span style="color:#a6e22e">Scheme</span>      <span style="color:#66d9ef">string</span>
</span></span><span style="display:flex;"><span>	<span style="color:#a6e22e">Opaque</span>      <span style="color:#66d9ef">string</span>    <span style="color:#75715e">// encoded opaque data
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>	<span style="color:#a6e22e">User</span>        <span style="color:#f92672">*</span><span style="color:#a6e22e">Userinfo</span> <span style="color:#75715e">// username and password information
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>	<span style="color:#a6e22e">Host</span>        <span style="color:#66d9ef">string</span>    <span style="color:#75715e">// host or host:port
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>	<span style="color:#a6e22e">Path</span>        <span style="color:#66d9ef">string</span>    <span style="color:#75715e">// path (relative paths may omit leading slash)
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>	<span style="color:#a6e22e">RawPath</span>     <span style="color:#66d9ef">string</span>    <span style="color:#75715e">// encoded path hint (see EscapedPath method)
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>	<span style="color:#a6e22e">ForceQuery</span>  <span style="color:#66d9ef">bool</span>      <span style="color:#75715e">// append a query (&#39;?&#39;) even if RawQuery is empty
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>	<span style="color:#a6e22e">RawQuery</span>    <span style="color:#66d9ef">string</span>    <span style="color:#75715e">// encoded query values, without &#39;?&#39;
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>	<span style="color:#a6e22e">Fragment</span>    <span style="color:#66d9ef">string</span>    <span style="color:#75715e">// fragment for references, without &#39;#&#39;
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>	<span style="color:#a6e22e">RawFragment</span> <span style="color:#66d9ef">string</span>    <span style="color:#75715e">// encoded fragment hint (see EscapedFragment method)
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>}
</span></span></code></pre></div><h4 id="è¯·æ±‚é¦–éƒ¨">è¯·æ±‚é¦–éƒ¨</h4>
<p>ä¸€ä¸ªè¯·æ±‚çš„Demoï¼š</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-http" data-lang="http"><span style="display:flex;"><span><span style="color:#a6e22e">GET</span> / <span style="color:#66d9ef">HTTP</span><span style="color:#f92672">/</span><span style="color:#ae81ff">1.1</span>
</span></span><span style="display:flex;"><span>Host<span style="color:#f92672">:</span> <span style="color:#ae81ff">hackr.jp</span>
</span></span><span style="display:flex;"><span>User-Agent<span style="color:#f92672">:</span> <span style="color:#ae81ff">Mozilla/5.0 (Windows NT 6.1; WOW64; rv:13.0) Gecko/20100101 Firefox/13.0</span>
</span></span><span style="display:flex;"><span>Accept<span style="color:#f92672">:</span> <span style="color:#ae81ff">text/html,application/xhtml+xml,application/xml;q=0.9,*/*; q=0.8</span>
</span></span><span style="display:flex;"><span>Accept-Language<span style="color:#f92672">:</span> <span style="color:#ae81ff">ja,en-us;q=0.7,en;q=0.3</span>
</span></span><span style="display:flex;"><span>Accept-Encoding<span style="color:#f92672">:</span> <span style="color:#ae81ff">gzip, deflate DNT: 1</span>
</span></span><span style="display:flex;"><span>Connection<span style="color:#f92672">:</span> <span style="color:#ae81ff">keep-alive</span>
</span></span><span style="display:flex;"><span>If-Modified-Since<span style="color:#f92672">:</span> <span style="color:#ae81ff">Fri, 31 Aug 2007 02:02:20 GMT</span>
</span></span><span style="display:flex;"><span>If-None-Match<span style="color:#f92672">:</span> <span style="color:#ae81ff">&#34;45bae1-16a-46d776ac&#34;</span>
</span></span><span style="display:flex;"><span>Cache-Control<span style="color:#f92672">:</span> <span style="color:#ae81ff">max-age=0</span>
</span></span></code></pre></div><p>Goæ‹¿åˆ°çš„æ˜¯è¿™æ ·çš„ï¼š</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span><span style="color:#75715e">// http.Request
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#f92672">&amp;</span>{<span style="color:#a6e22e">GET</span> <span style="color:#f92672">/</span><span style="color:#a6e22e">body</span> <span style="color:#a6e22e">HTTP</span><span style="color:#f92672">/</span><span style="color:#ae81ff">1.1</span> <span style="color:#ae81ff">1</span> <span style="color:#ae81ff">1</span> <span style="color:#66d9ef">map</span>[<span style="color:#a6e22e">Accept</span>:[<span style="color:#a6e22e">text</span><span style="color:#f92672">/</span><span style="color:#a6e22e">html</span>,<span style="color:#a6e22e">application</span><span style="color:#f92672">/</span><span style="color:#a6e22e">xhtml</span><span style="color:#f92672">+</span><span style="color:#a6e22e">xml</span>,<span style="color:#a6e22e">application</span><span style="color:#f92672">/</span><span style="color:#a6e22e">xml</span>;<span style="color:#a6e22e">q</span>=<span style="color:#ae81ff">0.9</span>,<span style="color:#a6e22e">image</span><span style="color:#f92672">/</span><span style="color:#a6e22e">webp</span>,<span style="color:#a6e22e">image</span><span style="color:#f92672">/</span><span style="color:#a6e22e">apng</span>,<span style="color:#f92672">*/*</span>;<span style="color:#a6e22e">q</span>=<span style="color:#ae81ff">0.8</span>,<span style="color:#a6e22e">application</span><span style="color:#f92672">/</span><span style="color:#a6e22e">signed</span><span style="color:#f92672">-</span><span style="color:#a6e22e">exchange</span>;<span style="color:#a6e22e">v</span>=<span style="color:#a6e22e">b3</span>;<span style="color:#a6e22e">q</span>=<span style="color:#ae81ff">0.9</span>] <span style="color:#a6e22e">Accept</span><span style="color:#f92672">-</span><span style="color:#a6e22e">Encoding</span>:[<span style="color:#a6e22e">gzip</span>, <span style="color:#a6e22e">deflate</span>, <span style="color:#a6e22e">br</span>] <span style="color:#a6e22e">Accept</span><span style="color:#f92672">-</span><span style="color:#a6e22e">Language</span>:[<span style="color:#a6e22e">zh</span><span style="color:#f92672">-</span><span style="color:#a6e22e">CN</span>,<span style="color:#a6e22e">zh</span>;<span style="color:#a6e22e">q</span>=<span style="color:#ae81ff">0.9</span>,<span style="color:#a6e22e">en</span>;<span style="color:#a6e22e">q</span>=<span style="color:#ae81ff">0.8</span>,<span style="color:#a6e22e">en</span><span style="color:#f92672">-</span><span style="color:#a6e22e">GB</span>;<span style="color:#a6e22e">q</span>=<span style="color:#ae81ff">0.7</span>,<span style="color:#a6e22e">en</span><span style="color:#f92672">-</span><span style="color:#a6e22e">US</span>;<span style="color:#a6e22e">q</span>=<span style="color:#ae81ff">0.6</span>] <span style="color:#a6e22e">Cache</span><span style="color:#f92672">-</span><span style="color:#a6e22e">Control</span>:[<span style="color:#a6e22e">max</span><span style="color:#f92672">-</span><span style="color:#a6e22e">age</span>=<span style="color:#ae81ff">0</span>] <span style="color:#a6e22e">Connection</span>:[<span style="color:#a6e22e">keep</span><span style="color:#f92672">-</span><span style="color:#a6e22e">alive</span>] <span style="color:#a6e22e">Cookie</span>:[<span style="color:#a6e22e">csrftoken</span>=<span style="color:#a6e22e">AFpbq4QNxdr35oU4SgESrmHLGtgbjLIUrDIkod4ZjsQIq1hynjiMRYphYluqomNE</span>] <span style="color:#a6e22e">Sec</span><span style="color:#f92672">-</span><span style="color:#a6e22e">Ch</span><span style="color:#f92672">-</span><span style="color:#a6e22e">Ua</span>:[<span style="color:#e6db74">&#34;Chromium&#34;</span>;<span style="color:#a6e22e">v</span>=<span style="color:#e6db74">&#34;94&#34;</span>, <span style="color:#e6db74">&#34;Microsoft Edge&#34;</span>;<span style="color:#a6e22e">v</span>=<span style="color:#e6db74">&#34;94&#34;</span>, <span style="color:#e6db74">&#34;;Not A Brand&#34;</span>;<span style="color:#a6e22e">v</span>=<span style="color:#e6db74">&#34;99&#34;</span>] <span style="color:#a6e22e">Sec</span><span style="color:#f92672">-</span><span style="color:#a6e22e">Ch</span><span style="color:#f92672">-</span><span style="color:#a6e22e">Ua</span><span style="color:#f92672">-</span><span style="color:#a6e22e">Mobile</span>:[<span style="color:#960050;background-color:#1e0010">?</span><span style="color:#ae81ff">0</span>] <span style="color:#a6e22e">Sec</span><span style="color:#f92672">-</span><span style="color:#a6e22e">Ch</span><span style="color:#f92672">-</span><span style="color:#a6e22e">Ua</span><span style="color:#f92672">-</span><span style="color:#a6e22e">Platform</span>:[<span style="color:#e6db74">&#34;Windows&#34;</span>] <span style="color:#a6e22e">Sec</span><span style="color:#f92672">-</span><span style="color:#a6e22e">Fetch</span><span style="color:#f92672">-</span><span style="color:#a6e22e">Dest</span>:[<span style="color:#a6e22e">document</span>] <span style="color:#a6e22e">Sec</span><span style="color:#f92672">-</span><span style="color:#a6e22e">Fetch</span><span style="color:#f92672">-</span><span style="color:#a6e22e">Mode</span>:[<span style="color:#a6e22e">navigate</span>] <span style="color:#a6e22e">Sec</span><span style="color:#f92672">-</span><span style="color:#a6e22e">Fetch</span><span style="color:#f92672">-</span><span style="color:#a6e22e">Site</span>:[<span style="color:#a6e22e">none</span>] <span style="color:#a6e22e">Sec</span><span style="color:#f92672">-</span><span style="color:#a6e22e">Fetch</span><span style="color:#f92672">-</span><span style="color:#a6e22e">User</span>:[<span style="color:#960050;background-color:#1e0010">?</span><span style="color:#ae81ff">1</span>] <span style="color:#a6e22e">Upgrade</span><span style="color:#f92672">-</span><span style="color:#a6e22e">Insecure</span><span style="color:#f92672">-</span><span style="color:#a6e22e">Requests</span>:[<span style="color:#ae81ff">1</span>] <span style="color:#a6e22e">User</span><span style="color:#f92672">-</span><span style="color:#a6e22e">Agent</span>:[<span style="color:#a6e22e">Mozilla</span><span style="color:#f92672">/</span><span style="color:#ae81ff">5.0</span> (<span style="color:#a6e22e">Windows</span> <span style="color:#a6e22e">NT</span> <span style="color:#ae81ff">10.0</span>; <span style="color:#a6e22e">Win64</span>; <span style="color:#a6e22e">x64</span>) <span style="color:#a6e22e">AppleWebKit</span><span style="color:#f92672">/</span><span style="color:#ae81ff">537.36</span> (<span style="color:#a6e22e">KHTML</span>, <span style="color:#a6e22e">like</span> <span style="color:#a6e22e">Gecko</span>) <span style="color:#a6e22e">Chrome</span><span style="color:#f92672">/</span><span style="color:#ae81ff">94.0.4606.81</span> <span style="color:#a6e22e">Safari</span><span style="color:#f92672">/</span><span style="color:#ae81ff">537.36</span> <span style="color:#a6e22e">Edg</span><span style="color:#f92672">/</span><span style="color:#ae81ff">94.0.992.47</span>]] {} &lt;<span style="color:#66d9ef">nil</span>&gt; <span style="color:#ae81ff">0</span> [] <span style="color:#66d9ef">false</span> <span style="color:#ae81ff">127.0.0.1</span>:<span style="color:#ae81ff">8080</span> <span style="color:#66d9ef">map</span>[] <span style="color:#66d9ef">map</span>[] &lt;<span style="color:#66d9ef">nil</span>&gt; <span style="color:#66d9ef">map</span>[] <span style="color:#ae81ff">127.0.0.1</span>:<span style="color:#ae81ff">64798</span> <span style="color:#f92672">/</span><span style="color:#a6e22e">body</span> &lt;<span style="color:#66d9ef">nil</span>&gt; &lt;<span style="color:#66d9ef">nil</span>&gt; &lt;<span style="color:#66d9ef">nil</span>&gt; <span style="color:#ae81ff">0xc0000f42c0</span>}
</span></span></code></pre></div><p>è¯·æ±‚ä½“æ˜¯ä¸€ä¸ª<code>map</code>ç»“æ„çš„æ•°æ®ï¼Œæ¯”å¦‚ï¼š</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span><span style="color:#66d9ef">map</span>[
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">Accept</span>:[<span style="color:#a6e22e">text</span><span style="color:#f92672">/</span><span style="color:#a6e22e">html</span>,<span style="color:#a6e22e">application</span><span style="color:#f92672">/</span><span style="color:#a6e22e">xhtml</span><span style="color:#f92672">+</span><span style="color:#a6e22e">xml</span>,<span style="color:#a6e22e">application</span><span style="color:#f92672">/</span><span style="color:#a6e22e">xml</span>;<span style="color:#a6e22e">q</span>=<span style="color:#ae81ff">0.9</span>,<span style="color:#a6e22e">image</span><span style="color:#f92672">/</span><span style="color:#a6e22e">webp</span>,<span style="color:#a6e22e">image</span><span style="color:#f92672">/</span><span style="color:#a6e22e">apng</span>,<span style="color:#f92672">*/*</span>;<span style="color:#a6e22e">q</span>=<span style="color:#ae81ff">0.8</span>,<span style="color:#a6e22e">application</span><span style="color:#f92672">/</span><span style="color:#a6e22e">signed</span><span style="color:#f92672">-</span><span style="color:#a6e22e">exchange</span>;<span style="color:#a6e22e">v</span>=<span style="color:#a6e22e">b3</span>;<span style="color:#a6e22e">q</span>=<span style="color:#ae81ff">0.9</span>] 
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">Accept</span><span style="color:#f92672">-</span><span style="color:#a6e22e">Encoding</span>:[<span style="color:#a6e22e">gzip</span>, <span style="color:#a6e22e">deflate</span>, <span style="color:#a6e22e">br</span>] 
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">Accept</span><span style="color:#f92672">-</span><span style="color:#a6e22e">Language</span>:[<span style="color:#a6e22e">zh</span><span style="color:#f92672">-</span><span style="color:#a6e22e">CN</span>,<span style="color:#a6e22e">zh</span>;<span style="color:#a6e22e">q</span>=<span style="color:#ae81ff">0.9</span>,<span style="color:#a6e22e">en</span>;<span style="color:#a6e22e">q</span>=<span style="color:#ae81ff">0.8</span>,<span style="color:#a6e22e">en</span><span style="color:#f92672">-</span><span style="color:#a6e22e">GB</span>;<span style="color:#a6e22e">q</span>=<span style="color:#ae81ff">0.7</span>,<span style="color:#a6e22e">en</span><span style="color:#f92672">-</span><span style="color:#a6e22e">US</span>;<span style="color:#a6e22e">q</span>=<span style="color:#ae81ff">0.6</span>] 
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">Cache</span><span style="color:#f92672">-</span><span style="color:#a6e22e">Control</span>:[<span style="color:#a6e22e">max</span><span style="color:#f92672">-</span><span style="color:#a6e22e">age</span>=<span style="color:#ae81ff">0</span>] 
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">Connection</span>:[<span style="color:#a6e22e">keep</span><span style="color:#f92672">-</span><span style="color:#a6e22e">alive</span>] 
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">Cookie</span>:[<span style="color:#a6e22e">csrftoken</span>=<span style="color:#a6e22e">AFpbq4uy3rn35oU4SkESrmHLGwvqjLIjuDIkod4ZjsQIq1uknHiMRYphYluqomNE</span>] 
</span></span><span style="display:flex;"><span>	<span style="color:#f92672">...</span>.
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">Upgrade</span><span style="color:#f92672">-</span><span style="color:#a6e22e">Insecure</span><span style="color:#f92672">-</span><span style="color:#a6e22e">Requests</span>:[<span style="color:#ae81ff">1</span>] 
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">User</span><span style="color:#f92672">-</span><span style="color:#a6e22e">Agent</span>:[<span style="color:#a6e22e">Mozilla</span><span style="color:#f92672">/</span><span style="color:#ae81ff">5.0</span> (<span style="color:#a6e22e">Windows</span> <span style="color:#a6e22e">NT</span> <span style="color:#ae81ff">10.0</span>; <span style="color:#a6e22e">Win64</span>; <span style="color:#a6e22e">x64</span>) <span style="color:#a6e22e">AppleWebKit</span><span style="color:#f92672">/</span><span style="color:#ae81ff">537.36</span> (<span style="color:#a6e22e">KHTML</span>, <span style="color:#a6e22e">like</span> <span style="color:#a6e22e">Gecko</span>) <span style="color:#a6e22e">Chrome</span><span style="color:#f92672">/</span><span style="color:#ae81ff">94.0.4606.81</span> <span style="color:#a6e22e">Safari</span><span style="color:#f92672">/</span><span style="color:#ae81ff">537.36</span> <span style="color:#a6e22e">Edg</span><span style="color:#f92672">/</span><span style="color:#ae81ff">94.0.992.47</span>]
</span></span><span style="display:flex;"><span>]
</span></span></code></pre></div><p>å¯ä»¥é€šè¿‡ï¼š</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span><span style="color:#a6e22e">r</span>.<span style="color:#a6e22e">Header</span>[<span style="color:#e6db74">&#34;key&#34;</span>]
</span></span><span style="display:flex;"><span><span style="color:#75715e">// or
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#a6e22e">r</span>.<span style="color:#a6e22e">Header</span>.<span style="color:#a6e22e">Get</span>(<span style="color:#e6db74">&#34;key&#34;</span>)
</span></span></code></pre></div><p>æ‹¿åˆ°è¯·æ±‚é¦–éƒ¨æ•°æ®ã€‚</p>
<h4 id="è¯·æ±‚ä¸»ä½“">è¯·æ±‚ä¸»ä½“</h4>
<p>**ä¸€èˆ¬çš„ï¼ŒGETè¯·æ±‚æ²¡æœ‰Bodyå†…å®¹ï¼Œåªæœ‰ä½¿ç”¨POSTæ–¹å¼æäº¤çš„è¯·æ±‚æ‰æœ‰Bodyã€‚**è€ŒGETæ–¹å¼ä¼ é€’çš„æ•°æ®æ”¾åœ¨URLä¸­ä»¥é”®å€¼å¯¹çš„å½¢å¼è¿›è¡Œä¼ é€’ã€‚</p>
<p>è¿™æ˜¯ä¸€ä¸ªPOSTè¯·æ±‚çš„Demoï¼š</p>
<p><img src="https://raw.githubusercontent.com/lizonglin313/MyPicGo/master/20211015170911.png"
	
	
	
	loading="lazy"
	
	
></p>
<p>è¯·æ±‚ä¸­ç”¨æˆ·å‘é€çš„æ•°æ®æ˜¯æœåŠ¡ç«¯æ‰€éœ€è¦çš„ã€‚ä¸€èˆ¬çš„ï¼Œè¿™äº›æ•°æ®éƒ½æ˜¯ä»è¡¨å•ä¸­è·å–çš„ã€‚</p>
<h3 id="ä»è¡¨å•ä¸­è·å–æ•°æ®">ä»è¡¨å•ä¸­è·å–æ•°æ®</h3>
<p>éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œ<strong>HTMLè¡¨å•çš„æ•°æ®ç±»å‹å†³å®šäº†POSTåœ¨å‘é€é”®å€¼å¯¹æ—¶ä½¿ç”¨ä»€ä¹ˆæ ·çš„æ ¼å¼</strong>ã€‚</p>
<div class="table-wrapper"><table>
<thead>
<tr>
<th style="text-align:left">å€¼</th>
<th style="text-align:left">æè¿°</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">application/x-www-form-urlencoded</td>
<td style="text-align:left">é»˜è®¤çš„ï¼Œæµè§ˆå™¨åœ¨å‘é€å‰å°†æ‰€æœ‰æäº¤çš„æ•°æ®ç¼–ç æˆé•¿å­—ç¬¦ä¸²ï¼Œä¸åŒçš„é”®å€¼å¯¹ç”¨â€œ&amp;â€éš”å¼€ï¼Œå¦‚ï¼šfirst_name=li&amp;last_name=duoã€‚è¿™ç§ç¼–ç æ›´åŠ ç®€å•å’Œé«˜æ•ˆã€‚</td>
</tr>
<tr>
<td style="text-align:left">multipart/form-data</td>
<td style="text-align:left">è¡¨å•çš„æ•°æ®è½¬æ¢æˆMIMEæŠ¥æ–‡ã€‚åœ¨ä½¿ç”¨åŒ…å«æ–‡ä»¶ä¸Šä¼ æ§ä»¶çš„è¡¨å•æ—¶ï¼Œå¿…é¡»ä½¿ç”¨è¯¥å€¼ã€‚</td>
</tr>
<tr>
<td style="text-align:left">text/plain</td>
<td style="text-align:left">ç©ºæ ¼è½¬æ¢ä¸º &ldquo;+&rdquo; åŠ å·ï¼Œä½†ä¸å¯¹ç‰¹æ®Šå­—ç¬¦ç¼–ç ã€‚</td>
</tr>
</tbody>
</table></div>
<p>è®¾<code>r</code>æ˜¯ä¸€ä¸ª<code>http.Request</code>ï¼Œè·å–æ•°æ®çš„æ–¹å¼æœ‰ï¼š</p>
<p><img src="https://raw.githubusercontent.com/lizonglin313/MyPicGo/master/20211015175001.png"
	
	
	
	loading="lazy"
	
	
></p>
<h4 id="å…³äºæ–‡ä»¶">å…³äºæ–‡ä»¶</h4>
<p>ä»Formä¸­æ‹¿åˆ°æ–‡ä»¶éœ€è¦<code>r.ParseMultipartForm</code>å’Œ<code>r.MultipartForm.File</code>æ¥è·å–ã€‚</p>
<h3 id="æœåŠ¡å™¨åšå‡ºå“åº”">æœåŠ¡å™¨åšå‡ºå“åº”</h3>
<p><strong>æœåŠ¡å™¨ç»™å®¢æˆ·ç«¯è¿”å›å“åº”ä½¿ç”¨çš„æ˜¯</strong><code>http.ResponseWriter</code>ï¼Œ<strong>åœ¨åˆ›å»ºå“åº”æ—¶ä½¿ç”¨äº†</strong><code>http.response</code>ã€‚</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span><span style="color:#66d9ef">type</span> <span style="color:#a6e22e">ResponseWriter</span> <span style="color:#66d9ef">interface</span> {
</span></span><span style="display:flex;"><span>	<span style="color:#a6e22e">Header</span>() <span style="color:#a6e22e">Header</span>
</span></span><span style="display:flex;"><span>	<span style="color:#a6e22e">Write</span>([]<span style="color:#66d9ef">byte</span>) (<span style="color:#66d9ef">int</span>, <span style="color:#66d9ef">error</span>)
</span></span><span style="display:flex;"><span>	<span style="color:#a6e22e">WriteHeader</span>(<span style="color:#a6e22e">statusCode</span> <span style="color:#66d9ef">int</span>)
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">// http.response æ˜¯ä¸å¯å¯¼å‡ºçš„
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#66d9ef">type</span> <span style="color:#a6e22e">response</span> <span style="color:#66d9ef">struct</span> {
</span></span><span style="display:flex;"><span>	<span style="color:#a6e22e">conn</span>             <span style="color:#f92672">*</span><span style="color:#a6e22e">conn</span>
</span></span><span style="display:flex;"><span>	<span style="color:#a6e22e">req</span>              <span style="color:#f92672">*</span><span style="color:#a6e22e">Request</span> 
</span></span><span style="display:flex;"><span>	<span style="color:#a6e22e">reqBody</span>          <span style="color:#a6e22e">io</span>.<span style="color:#a6e22e">ReadCloser</span>
</span></span><span style="display:flex;"><span>	<span style="color:#a6e22e">w</span>  <span style="color:#f92672">*</span><span style="color:#a6e22e">bufio</span>.<span style="color:#a6e22e">Writer</span> 
</span></span><span style="display:flex;"><span>	<span style="color:#a6e22e">handlerHeader</span> <span style="color:#a6e22e">Header</span>
</span></span><span style="display:flex;"><span>	<span style="color:#a6e22e">calledHeader</span>  <span style="color:#66d9ef">bool</span> 
</span></span><span style="display:flex;"><span>	<span style="color:#a6e22e">written</span>       <span style="color:#66d9ef">int64</span> 
</span></span><span style="display:flex;"><span>	<span style="color:#a6e22e">contentLength</span> <span style="color:#66d9ef">int64</span> 
</span></span><span style="display:flex;"><span>	<span style="color:#a6e22e">status</span>        <span style="color:#66d9ef">int</span>   
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">...</span>
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p><strong>è¿™é‡Œæœ‰ä¸€ä¸ªå€¼å¾—æ³¨æ„çš„åœ°æ–¹ï¼šServerHTTPä¸­ï¼Œä¸ºä»€ä¹ˆ</strong><code>http.ResponseWriter</code><strong>ä¼ å€¼</strong>ï¼Œ<strong>è€Œ</strong><code>http.Request</code><strong>æ˜¯ä»¥æŒ‡é’ˆå¼•ç”¨æ–¹å¼ä¼ é€’çš„å‘¢ï¼Ÿ</strong></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span><span style="color:#66d9ef">type</span> <span style="color:#a6e22e">Handler</span> <span style="color:#66d9ef">interface</span> {
</span></span><span style="display:flex;"><span>	<span style="color:#a6e22e">ServeHTTP</span>(<span style="color:#a6e22e">ResponseWriter</span>, <span style="color:#f92672">*</span><span style="color:#a6e22e">Request</span>)
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>é¦–å…ˆï¼Œ<code>*http.Request</code>ä½¿ç”¨æŒ‡é’ˆä¼ é€’å¼•ç”¨æ˜¯å› ä¸ºï¼šæœåŠ¡å™¨éœ€è¦å¯Ÿè§‰æˆ‘ä»¬å¯¹<code>Request</code>ç»“æ„çš„ä¿®æ”¹ï¼Œæ‰€ä»¥å¿…é¡»è¦ä¼ å¼•ç”¨ã€‚é‚£æœåŠ¡å™¨ä¸ç”¨å¯Ÿè§‰<code>Response</code>çš„ä¿®æ”¹å—ï¼Ÿä¹Ÿç”¨ã€‚</p>
<p>æ‰€ä»¥ï¼Œåœ¨<code>http.ResponseWriter</code>æ¥å£çš„å®ç°<code>response</code>ä¸­ï¼Œ<code>response</code>æ˜¯ä»¥å¼•ç”¨ä¼ é€’çš„ã€‚å¯ä»¥ç†è§£ä¸ºï¼Œ<code>http.ResponseWriter</code>ä¸­æ˜¯<code>*response</code>ã€‚æ‰€ä»¥å®é™…ä¸Šï¼Œä¼ é€’çš„è¿˜æ˜¯å¼•ç”¨ã€‚</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span><span style="color:#66d9ef">func</span> (<span style="color:#a6e22e">w</span> <span style="color:#f92672">*</span><span style="color:#a6e22e">response</span>) <span style="color:#a6e22e">Header</span>() <span style="color:#a6e22e">Header</span> {
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">if</span> <span style="color:#a6e22e">w</span>.<span style="color:#a6e22e">cw</span>.<span style="color:#a6e22e">header</span> <span style="color:#f92672">==</span> <span style="color:#66d9ef">nil</span> <span style="color:#f92672">&amp;&amp;</span> <span style="color:#a6e22e">w</span>.<span style="color:#a6e22e">wroteHeader</span> <span style="color:#f92672">&amp;&amp;</span> !<span style="color:#a6e22e">w</span>.<span style="color:#a6e22e">cw</span>.<span style="color:#a6e22e">wroteHeader</span> {
</span></span><span style="display:flex;"><span>		<span style="color:#75715e">// Accessing the header between logically writing it
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>		<span style="color:#75715e">// and physically writing it means we need to allocate
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>		<span style="color:#75715e">// a clone to snapshot the logically written state.
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>		<span style="color:#a6e22e">w</span>.<span style="color:#a6e22e">cw</span>.<span style="color:#a6e22e">header</span> = <span style="color:#a6e22e">w</span>.<span style="color:#a6e22e">handlerHeader</span>.<span style="color:#a6e22e">Clone</span>()
</span></span><span style="display:flex;"><span>	}
</span></span><span style="display:flex;"><span>	<span style="color:#a6e22e">w</span>.<span style="color:#a6e22e">calledHeader</span> = <span style="color:#66d9ef">true</span>
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">return</span> <span style="color:#a6e22e">w</span>.<span style="color:#a6e22e">handlerHeader</span>
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>å¯ä»¥çœ‹åˆ°ï¼Œ<code>response</code>åœ¨å®ç°<code>http.ResponseWriter</code>æ¥å£æ—¶ï¼Œæ˜¯ä»¥å¼•ç”¨çš„æ–¹å¼ã€‚</p>
<p>æœ‰å¤šç§æ–¹æ³•å¯ä»¥å¯¹<code>ResponseWriter</code>è¿›è¡Œå†™å…¥ï¼š</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span><span style="color:#75715e">// ä½¿ç”¨ write æ–¹æ³•å°†æ•°æ®å†™å…¥ http Respons bodyä¸­
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#66d9ef">func</span> <span style="color:#a6e22e">write</span>(<span style="color:#a6e22e">w</span> <span style="color:#a6e22e">http</span>.<span style="color:#a6e22e">ResponseWriter</span>, <span style="color:#a6e22e">r</span> <span style="color:#f92672">*</span><span style="color:#a6e22e">http</span>.<span style="color:#a6e22e">Request</span>) {
</span></span><span style="display:flex;"><span>	<span style="color:#a6e22e">str</span> <span style="color:#f92672">:=</span> <span style="color:#e6db74">&#34;info&#34;</span>
</span></span><span style="display:flex;"><span>	<span style="color:#a6e22e">w</span>.<span style="color:#a6e22e">Write</span>([]byte(<span style="color:#a6e22e">str</span>))
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">// å¯¹ Response header è¿›è¡Œè®¾ç½® å¦‚çŠ¶æ€ç ç­‰ä¿¡æ¯
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">// @Notice:	WriteHeader æ‰§è¡Œå®Œæ¯•å ä¸å…è®¸å†å†™å…¥ä¿¡æ¯äº†
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#66d9ef">func</span> <span style="color:#a6e22e">header</span>(<span style="color:#a6e22e">w</span> <span style="color:#a6e22e">http</span>.<span style="color:#a6e22e">ResponseWriter</span>, <span style="color:#a6e22e">r</span> <span style="color:#f92672">*</span><span style="color:#a6e22e">http</span>.<span style="color:#a6e22e">Request</span>) {
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">// è®¾ç½® Location å®ç° é‡å®šå‘é¡µé¢
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>	<span style="color:#a6e22e">w</span>.<span style="color:#a6e22e">Header</span>().<span style="color:#a6e22e">Set</span>(<span style="color:#e6db74">&#34;Location&#34;</span>, <span style="color:#e6db74">&#34;https://lizonglin313.github.io/&#34;</span>)
</span></span><span style="display:flex;"><span>	<span style="color:#a6e22e">w</span>.<span style="color:#a6e22e">Header</span>().<span style="color:#a6e22e">Set</span>(<span style="color:#e6db74">&#34;A&#34;</span>, <span style="color:#e6db74">&#34;aaa&#34;</span>)
</span></span><span style="display:flex;"><span>	<span style="color:#a6e22e">w</span>.<span style="color:#a6e22e">WriteHeader</span>(<span style="color:#ae81ff">302</span>)	<span style="color:#75715e">// å†™å…¥çŠ¶æ€ç 
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">// å‘å“åº”ä¸­å†™å…¥ JSON æ ¼å¼çš„æ•°æ®
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">// @Notice:	è¦é¦–å…ˆ ä½¿ç”¨ Header å°†ç›¸åº”çš„å†…å®¹ è®¾ç½®ä¸º JSON æ ¼å¼
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#66d9ef">func</span> <span style="color:#a6e22e">outputJSON</span>(<span style="color:#a6e22e">w</span> <span style="color:#a6e22e">http</span>.<span style="color:#a6e22e">ResponseWriter</span>, <span style="color:#a6e22e">r</span> <span style="color:#f92672">*</span><span style="color:#a6e22e">http</span>.<span style="color:#a6e22e">Request</span>) {
</span></span><span style="display:flex;"><span>	<span style="color:#a6e22e">w</span>.<span style="color:#a6e22e">Header</span>().<span style="color:#a6e22e">Set</span>(<span style="color:#e6db74">&#34;Content-Type&#34;</span>, <span style="color:#e6db74">&#34;application/json&#34;</span>)
</span></span><span style="display:flex;"><span>	<span style="color:#a6e22e">post</span> <span style="color:#f92672">:=</span> <span style="color:#f92672">&amp;</span><span style="color:#a6e22e">Post</span>{	<span style="color:#75715e">// Post æ˜¯ä¸€ä¸ªå®ç°æ‰“å¥½ JSON Tagçš„ç»“æ„ä½“
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>		<span style="color:#a6e22e">User</span>:    <span style="color:#e6db74">&#34;lzl&#34;</span>,
</span></span><span style="display:flex;"><span>		<span style="color:#a6e22e">Threads</span>: []<span style="color:#66d9ef">string</span>{<span style="color:#e6db74">&#34;1&#34;</span>, <span style="color:#e6db74">&#34;2&#34;</span>, <span style="color:#e6db74">&#34;3&#34;</span>},
</span></span><span style="display:flex;"><span>	}
</span></span><span style="display:flex;"><span>	<span style="color:#a6e22e">jsonByte</span>, <span style="color:#a6e22e">_</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">json</span>.<span style="color:#a6e22e">Marshal</span>(<span style="color:#a6e22e">post</span>)
</span></span><span style="display:flex;"><span>	<span style="color:#a6e22e">w</span>.<span style="color:#a6e22e">Write</span>(<span style="color:#a6e22e">jsonByte</span>)
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><h3 id="cookie">Cookie</h3>
<p>cookieå¸¸ç”¨äºå®¢æˆ·ç«¯æŒä¹…åŒ–åœºæ™¯ä¸­ï¼Œå½“<strong>å®¢æˆ·ç«¯å‘æœåŠ¡å™¨å‘å‡ºä¸€ä¸ªHTTPè¯·æ±‚æ—¶ï¼Œcookieä¼šéšç€ä¸€èµ·è¢«å‘åˆ°æœåŠ¡å™¨</strong>ã€‚</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span><span style="color:#66d9ef">type</span> <span style="color:#a6e22e">Cookie</span> <span style="color:#66d9ef">struct</span> {
</span></span><span style="display:flex;"><span>	<span style="color:#a6e22e">Name</span>  <span style="color:#66d9ef">string</span>
</span></span><span style="display:flex;"><span>	<span style="color:#a6e22e">Value</span> <span style="color:#66d9ef">string</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>	<span style="color:#a6e22e">Path</span>       <span style="color:#66d9ef">string</span>    <span style="color:#75715e">// optional
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>	<span style="color:#a6e22e">Domain</span>     <span style="color:#66d9ef">string</span>    <span style="color:#75715e">// optional
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>	<span style="color:#a6e22e">Expires</span>    <span style="color:#a6e22e">time</span>.<span style="color:#a6e22e">Time</span> <span style="color:#75715e">// optional
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>	<span style="color:#a6e22e">RawExpires</span> <span style="color:#66d9ef">string</span>    <span style="color:#75715e">// for reading cookies only
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>
</span></span><span style="display:flex;"><span>	<span style="color:#75715e">// MaxAge=0 è¡¨ç¤ºcookieåœ¨æµè§ˆå™¨å…³é—­åå¤±æ•ˆ
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>	<span style="color:#75715e">// MaxAge&lt;0 æ„å‘³ç€cookieå·²ç»è¿‡æœŸï¼Œå®¢æˆ·ç«¯æµè§ˆå™¨éœ€è¦ç«‹é©¬ç§»é™¤cookie
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>	<span style="color:#75715e">// MaxAge&gt;0 æ„å‘³cookieå¯ä»¥å­˜æ´»å¤šå°‘ç§’
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>	<span style="color:#a6e22e">MaxAge</span>   <span style="color:#66d9ef">int</span>
</span></span><span style="display:flex;"><span>	<span style="color:#a6e22e">Secure</span>   <span style="color:#66d9ef">bool</span>
</span></span><span style="display:flex;"><span>	<span style="color:#a6e22e">HttpOnly</span> <span style="color:#66d9ef">bool</span>
</span></span><span style="display:flex;"><span>	<span style="color:#a6e22e">SameSite</span> <span style="color:#a6e22e">SameSite</span>
</span></span><span style="display:flex;"><span>	<span style="color:#a6e22e">Raw</span>      <span style="color:#66d9ef">string</span>
</span></span><span style="display:flex;"><span>	<span style="color:#a6e22e">Unparsed</span> []<span style="color:#66d9ef">string</span> <span style="color:#75715e">// Raw text of unparsed attribute-value pairs
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>}
</span></span></code></pre></div><p>ä¸€èˆ¬çš„ï¼Œæ²¡æœ‰è®¾ç½®<code>Expires</code>çš„cookieæˆä¸ºä¼šè¯cookieï¼Œè¿™ç§cookieåœ¨æµè§ˆå™¨å…³é—­æ—¶è¢«è‡ªåŠ¨ç§»é™¤ï¼›ç›¸åçš„ï¼Œè®¾ç½®äº†çš„cookieç§°ä¸ºæŒä¹…cookieã€‚<code>Expires</code>æ˜ç¡®æŒ‡æ˜cookieåœ¨ä»€ä¹ˆæ—¶é—´ç‚¹è¿‡æœŸï¼Œè€Œ<code>MaxAge</code>åˆ™è¡¨ç¤ºè¿‡å¤šä¹…cookieä¼šè¿‡æœŸã€‚</p>
<h4 id="å‘æµè§ˆå™¨è®¾ç½®cookie">å‘æµè§ˆå™¨è®¾ç½®cookie</h4>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span><span style="color:#a6e22e">c1</span> = <span style="color:#a6e22e">http</span>.<span style="color:#a6e22e">Cookie</span>{<span style="color:#f92672">...</span>}
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">c2</span> = <span style="color:#a6e22e">http</span>.<span style="color:#a6e22e">Cookie</span>{<span style="color:#f92672">...</span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">// æ–¹æ³•ä¸€ï¼šå‘Headerä¸­è®¾ç½®ï¼Œæ³¨æ„ç¬¬äºŒä¸ªcookieéœ€è¦ä½ ä½¿ç”¨ Add è¿½åŠ  
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#a6e22e">w</span>.<span style="color:#a6e22e">Header</span>().<span style="color:#a6e22e">Set</span>(<span style="color:#e6db74">&#34;Set-Cookie&#34;</span>, <span style="color:#a6e22e">c1</span>.<span style="color:#a6e22e">String</span>())
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">w</span>.<span style="color:#a6e22e">Header</span>().<span style="color:#a6e22e">Add</span>(<span style="color:#e6db74">&#34;Set-Cookie&#34;</span>, <span style="color:#a6e22e">c2</span>.<span style="color:#a6e22e">String</span>())
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">// æ–¹æ³•äºŒï¼šä½¿ç”¨http.SetCookie() æ–¹æ³•ç›´æ¥è®¾ç½®
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">// è¿™ç§è®¾ç½®å¤šä¸ªcookieæ—¶å°±ä¸éœ€è¦ Add äº†
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#a6e22e">http</span>.<span style="color:#a6e22e">SetCookie</span>(<span style="color:#a6e22e">w</span>, <span style="color:#f92672">&amp;</span><span style="color:#a6e22e">c1</span>)
</span></span></code></pre></div><h4 id="ä»æµè§ˆå™¨è·å–cookie">ä»æµè§ˆå™¨è·å–cookie</h4>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span><span style="color:#75715e">// æ–¹æ³•ä¸€ï¼šç›´æ¥åœ¨Headeræ‹¿
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#a6e22e">cookie</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">r</span>.<span style="color:#a6e22e">Header</span>[<span style="color:#e6db74">&#34;Cookie&#34;</span>]
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">// æ–¹æ³•äºŒï¼šä½¿ç”¨ Cookie(&#34;key&#34;) æ–¹æ³•ï¼Œåªèƒ½æ‹¿åˆ°cookieåˆ—è¡¨ä¸­çš„é”®å€¼ä¸º key çš„cookieå€¼
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#a6e22e">cookie</span>, <span style="color:#a6e22e">err</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">r</span>.<span style="color:#a6e22e">Cookie</span>(<span style="color:#e6db74">&#34;first_cookie&#34;</span>)	<span style="color:#75715e">// r.Cookie è¿”å›ä¸€ä¸ª cookie æŒ‡é’ˆ
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">// æ–¹æ³•ä¸‰ï¼šä½¿ç”¨ Cookies() æ–¹æ³•æ‹¿åˆ°cookieåˆ—è¡¨ï¼Œè·å¾—æ‰€æœ‰cookie
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#a6e22e">cs</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">r</span>.<span style="color:#a6e22e">Cookies</span>()	<span style="color:#75715e">// r.Cookies è¿”å›ä¸€ä¸ª cookie çš„æŒ‡é’ˆåˆ‡ç‰‡
</span></span></span></code></pre></div><h4 id="é—ªç°æ¶ˆæ¯">é—ªç°æ¶ˆæ¯</h4>
<p>ä¸Šæ–‡ä¸­æåˆ°ï¼šcookieçš„<code>MaxAge&lt;0</code> æ„å‘³ç€cookieå·²ç»è¿‡æœŸï¼Œå®¢æˆ·ç«¯æµè§ˆå™¨éœ€è¦ç«‹é©¬ç§»é™¤cookieã€‚é€šè¿‡è¿™ä¸ªæ€§è´¨å¯ä»¥å®ç°ç±»ä¼¼å¼¹å‡ºæ¡†çš„é—ªç°æ¶ˆæ¯ã€‚</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span><span style="color:#75715e">// å°† æŸä¸ª cookie çš„ç”Ÿå­˜æ—¶é—´ ç½®ä¸º è´Ÿ
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">// å½“å†æ¬¡è¯·æ±‚è¿™ä¸ªå¤„ç†å™¨åï¼Œå°†æ‰¾ä¸åˆ° cookie key
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#66d9ef">func</span> <span style="color:#a6e22e">showMessage</span>(<span style="color:#a6e22e">w</span> <span style="color:#a6e22e">http</span>.<span style="color:#a6e22e">ResponseWriter</span>, <span style="color:#a6e22e">r</span> <span style="color:#f92672">*</span><span style="color:#a6e22e">http</span>.<span style="color:#a6e22e">Request</span>) {
</span></span><span style="display:flex;"><span>	<span style="color:#a6e22e">c</span>, <span style="color:#a6e22e">err</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">r</span>.<span style="color:#a6e22e">Cookie</span>(<span style="color:#e6db74">&#34;key&#34;</span>)
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">if</span> <span style="color:#a6e22e">err</span> <span style="color:#f92672">!=</span> <span style="color:#66d9ef">nil</span> {
</span></span><span style="display:flex;"><span>		<span style="color:#66d9ef">if</span> <span style="color:#a6e22e">err</span> <span style="color:#f92672">==</span> <span style="color:#a6e22e">http</span>.<span style="color:#a6e22e">ErrNoCookie</span> {
</span></span><span style="display:flex;"><span>			<span style="color:#a6e22e">fmt</span>.<span style="color:#a6e22e">Fprintln</span>(<span style="color:#a6e22e">w</span>, <span style="color:#e6db74">&#34;No message found!&#34;</span>)
</span></span><span style="display:flex;"><span>		}
</span></span><span style="display:flex;"><span>	} <span style="color:#66d9ef">else</span> {
</span></span><span style="display:flex;"><span>		<span style="color:#a6e22e">rc</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">http</span>.<span style="color:#a6e22e">Cookie</span>{
</span></span><span style="display:flex;"><span>			<span style="color:#a6e22e">Name</span>: <span style="color:#e6db74">&#34;key&#34;</span>,
</span></span><span style="display:flex;"><span>			<span style="color:#a6e22e">MaxAge</span>: <span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>,
</span></span><span style="display:flex;"><span>			<span style="color:#a6e22e">Expires</span>: <span style="color:#a6e22e">time</span>.<span style="color:#a6e22e">Unix</span>(<span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">0</span>),
</span></span><span style="display:flex;"><span>		}
</span></span><span style="display:flex;"><span>		<span style="color:#a6e22e">http</span>.<span style="color:#a6e22e">SetCookie</span>(<span style="color:#a6e22e">w</span>, <span style="color:#f92672">&amp;</span><span style="color:#a6e22e">rc</span>)
</span></span><span style="display:flex;"><span>		<span style="color:#a6e22e">fmt</span>.<span style="color:#a6e22e">Fprintln</span>(<span style="color:#a6e22e">w</span>, <span style="color:#e6db74">`If you refresh the page, you&#39;ll see &#34;No message found!&#34;`</span>)
</span></span><span style="display:flex;"><span>	}
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><h2 id="5-å†…å®¹å±•ç¤º">5. å†…å®¹å±•ç¤º</h2>
<p>Goçš„æ¨¡æ¿å¼•æ“é€šè¿‡å°†æ•°æ®å’Œæ¨¡æ¿ç»„åˆåœ¨ä¸€èµ·ï¼Œç”Ÿæˆæœ€ç»ˆçš„HTMLè¿”å›ç»™æµè§ˆå™¨ã€‚é€šå¸¸æ¨¡æ¿å¼•æ“æœ‰ä¸¤ç§ç±»å‹ï¼š</p>
<ul>
<li>æ— é€»è¾‘æ¨¡æ¿å¼•æ“ï¼šåœ¨æ¨¡æ¿ä¸­ä½¿ç”¨å ä½ç¬¦ï¼Œåœ¨å¡«å……æ•°æ®æ—¶ä»…ä»…ä½¿ç”¨å­—ç¬¦ä¸²æ›¿æ¢ã€‚</li>
<li>åµŒå…¥é€»è¾‘çš„æ¨¡æ¿å¼•æ“ï¼šåœ¨æ¨¡æ¿ä¸­è¿˜ä¼šæœ‰é€»è¾‘ä»£ç ï¼Œæ›´çµæ´»ï¼Œæ›´å¼ºå¤§ï¼Œèƒ½å¤„ç†æ•°æ®é€»è¾‘ã€‚</li>
</ul>
<p>Goçš„æ¨¡æ¿å¼•æ“æ˜¯ä»‹äºæ— é€»è¾‘æ¨¡æ¿å¼•æ“å’ŒåµŒå…¥é€»è¾‘æ¨¡æ¿å¼•æ“ä¹‹é—´çš„ä¸€ç§æ¨¡æ¿å¼•æ“ã€‚åˆ†åˆ«åœ¨<code>text/template</code>ä¸­å’Œ<code>html/template</code>ä¸­ï¼Œæ¥å¤„ç†ä»»æ„æ ¼å¼çš„æ–‡æœ¬æ•°æ®å’ŒHTMLæ ¼å¼ã€‚</p>
<p>ä½¿ç”¨Goçš„Webæ¨¡æ¿éœ€è¦ä¸¤ä¸ªæ­¥éª¤ï¼š</p>
<ol>
<li>å¯¹æ–‡æœ¬æ ¼å¼çš„æ¨¡æ¿è¿›è¡Œè¯­æ³•åˆ†æï¼Œåˆ›å»ºä¸€ä¸ªç»è¿‡è¯­æ³•åˆ†æçš„æ¨¡æ¿ç»“æ„ã€‚</li>
<li>å°†<code>ResponseWriter</code>å’Œæ¨¡æ¿æ‰€éœ€çš„åŠ¨æ€æ•°æ®ä¼ é€’ç»™æ¨¡æ¿å¼•æ“ï¼Œç”ŸæˆHTMLï¼Œç„¶åå†è¿”å›ç»™<code>ResponseWriter</code>ã€‚</li>
</ol>
<p>ä¾‹å¦‚ï¼š</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span><span style="color:#66d9ef">func</span> <span style="color:#a6e22e">process</span>(<span style="color:#a6e22e">w</span> <span style="color:#a6e22e">http</span>.<span style="color:#a6e22e">ResponseWriter</span>, <span style="color:#a6e22e">r</span> <span style="color:#f92672">*</span><span style="color:#a6e22e">http</span>.<span style="color:#a6e22e">Request</span>) {
</span></span><span style="display:flex;"><span>	<span style="color:#75715e">// æ¨¡æ¿æ–‡ä»¶è¿™é‡Œéœ€è¦å†™è·¯å¾„ï¼Œè€Œä¸”è·¯å¾„æœ€å‰é¢ä¸åŠ  /
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>	<span style="color:#a6e22e">t</span>, <span style="color:#a6e22e">_</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">template</span>.<span style="color:#a6e22e">ParseFiles</span>(<span style="color:#e6db74">&#34;go_web_Sau/day2/template/templates/temp1.html&#34;</span>)
</span></span><span style="display:flex;"><span>	<span style="color:#75715e">// ç”Ÿæˆæ•°æ®
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    <span style="color:#a6e22e">data</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">CreateData</span>()
</span></span><span style="display:flex;"><span>	<span style="color:#75715e">// å°†æ•°æ®å†™åˆ°æ¨¡æ¿ä¸­
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    <span style="color:#a6e22e">t</span>.<span style="color:#a6e22e">Execute</span>(<span style="color:#a6e22e">w</span>, <span style="color:#a6e22e">data</span>)
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><h3 id="æ¨¡æ¿çš„è¯­æ³•åˆ†æ">æ¨¡æ¿çš„è¯­æ³•åˆ†æ</h3>
<p>ä¸Šé¢çš„ä»£ç ä¸­ï¼Œæ‰§è¡Œäº†ï¼š</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span><span style="color:#a6e22e">t</span>, <span style="color:#a6e22e">_</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">template</span>.<span style="color:#a6e22e">ParseFiles</span>(<span style="color:#e6db74">&#34;filepath&#34;</span>)
</span></span></code></pre></div><p>è¿™å®é™…ä¸Šæ‰§è¡Œäº†ä¸¤ä¸ªåŠ¨ä½œï¼Œé¦–å…ˆä½¿ç”¨æ–‡ä»¶åˆ›å»ºå‡ºä¸€ä¸ªæ–°æ¨¡æ¿ï¼Œç„¶åå†è§£æå®ƒï¼š</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span><span style="color:#a6e22e">t</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">template</span>.<span style="color:#a6e22e">New</span>(<span style="color:#e6db74">&#34;filename&#34;</span>)
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">t</span>, <span style="color:#a6e22e">_</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">t</span>.<span style="color:#a6e22e">ParseFiles</span>(<span style="color:#e6db74">&#34;filepath&#34;</span>)
</span></span></code></pre></div><p><strong>ä½¿ç”¨è¿™ç§ä¸¤æ­¥çš„æ–¹æ³•éœ€è¦æ³¨æ„çš„æ˜¯</strong>ï¼š</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span><span style="color:#a6e22e">t</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">template</span>.<span style="color:#a6e22e">New</span>(<span style="color:#e6db74">&#34;temp6.html&#34;</span>).<span style="color:#a6e22e">Funcs</span>(<span style="color:#a6e22e">funcMap</span>)
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">t</span>,  <span style="color:#a6e22e">_</span> = <span style="color:#a6e22e">t</span>.<span style="color:#a6e22e">ParseFiles</span>(<span style="color:#e6db74">&#34;go_web_Sau/day2/template/templates/temp6.html&#34;</span>)
</span></span></code></pre></div><p><code>New()</code>å‡½æ•°åé¢ï¼Œåªèƒ½è·Ÿæ¨¡æ¿åå­—ï¼Œè€Œ<code>ParseFiles()</code>ä¸­éœ€è¦çš„æ˜¯ä»é¡¹ç›®æ ¹è·¯å¾„å¼€å§‹çš„ä¸€ä¸ªè·¯å¾„ã€‚</p>
<p>å…¶ä¸­ï¼Œ<code>ParseFiles()</code>å¯ä»¥<strong>æ¥æ”¶å¤šä¸ªæ–‡ä»¶åï¼Œä½†æ˜¯è¿™ç§æƒ…å†µä¸‹åªä¼šè¿”å›ç¬¬ä¸€ä¸ªæ–‡ä»¶çš„æ¨¡æ¿ï¼Œè‡³äºå…¶ä»–çš„æ¨¡æ¿ä¼šæ”¾åˆ°ä¸€ä¸ªæ˜ å°„é‡Œ</strong>ã€‚</p>
<p>Goçš„æ¨¡æ¿ä¸­ï¼Œå¯ä»¥åŒ…å«ä¸‹é¢å‡ ç§åŠ¨ä½œï¼š</p>
<ul>
<li>æ¡ä»¶åŠ¨ä½œï¼Œå¯¹ä¼ å…¥çš„æ•°æ®åšæ¡ä»¶åˆ¤æ–­</li>
<li>è¿­ä»£åŠ¨ä½œï¼Œå¯¹æ•°æ®è¿›è¡Œéå†</li>
<li>è®¾ç½®åŠ¨ä½œï¼Œåœ¨æ¨¡æ¿ä¸­å¯¹æ•°æ®èµ‹å€¼</li>
<li>åŒ…å«åŠ¨ä½œï¼Œæ¨¡æ¿å¯ä»¥ç›¸äº’è°ƒç”¨</li>
</ul>
<p>æ­¤å¤–ï¼Œåœ¨æ¨¡æ¿ä¸­è¿˜å¯ä»¥ä½¿ç”¨ï¼š</p>
<ul>
<li>ç®¡é“</li>
<li>ä¸ºæ¨¡æ¿ç»‘å®šå‡½æ•°</li>
<li>å¯¹äºä¸åŒçš„å¦‚HTMLè¯­æ³•ã€textæ ¼å¼è¿›è¡Œä¸Šä¸‹æ–‡æ„ŸçŸ¥ï¼Œä¾‹å¦‚å¯¹å°†Javascriptè„šæœ¬è½¬è¯‘æˆå¯è¯»å­—ç¬¦ä¸²ä»è€Œé¿å…XSSæ”»å‡»</li>
</ul>
<blockquote>
<p>æ›´å¤šå…³äºGo templateçš„å†…å®¹ï¼š</p>
<p><a class="link" href="https://www.liwenzhou.com/posts/Go/go_template/"  target="_blank" rel="noopener"
    >Goè¯­è¨€æ ‡å‡†åº“ä¹‹http/template | ææ–‡å‘¨çš„åšå®¢ (liwenzhou.com)</a></p>
<p><a class="link" href="https://github.com/lizonglin313/AdvancedGo/tree/main/go_web_Sau/day2/template"  target="_blank" rel="noopener"
    >æœ¬éƒ¨åˆ†å†…å®¹çš„æºç Demo-AdvancedGo/go_web_Sau/day2/template at main Â· lizonglin313/AdvancedGo (github.com)</a></p>
</blockquote>
<h2 id="6-å­˜å‚¨æ•°æ®">6. å­˜å‚¨æ•°æ®</h2>
<p>æœ¬ä¹¦çš„å­˜å‚¨æ¨¡æ¿ä¸»è¦æ˜¯ï¼š</p>
<ul>
<li>å†…å­˜å­˜å‚¨</li>
<li>CSVå­˜å‚¨</li>
<li>ä½¿ç”¨<code>gob</code>åŒ…è¿›è¡ŒäºŒè¿›åˆ¶å­˜å‚¨</li>
<li>ä½¿ç”¨æ•°æ®åº“å’Œæ•°æ®åº“å…³ç³»æ˜ å°„å™¨</li>
</ul>
<p>ä¸€èˆ¬çš„ï¼ŒWebåº”ç”¨å¯¹äºæ•°æ®çš„å­˜å‚¨æœ‰ä¸‰ç§ï¼š</p>
<ul>
<li>å°†æ•°æ®æš‚å­˜åˆ°å†…å­˜ä¸­</li>
<li>ç”Ÿæˆæ•°æ®æ–‡ä»¶ï¼Œå°†æ•°æ®å­˜å…¥æ–‡ä»¶ä¸­</li>
<li>ä½¿ç”¨æ•°æ®åº“è¿›è¡ŒæŒä¹…åŒ–å­˜å‚¨</li>
</ul>
<h3 id="å†…å­˜å­˜å‚¨">å†…å­˜å­˜å‚¨</h3>
<p>å†…å­˜å­˜å‚¨ä¸éœ€è¦è®¿é—®ç£ç›˜ï¼Œæ‰€ä»¥ä¸€èˆ¬æ¥è¯´é€Ÿåº¦æ˜¯æœ€å¿«çš„ã€‚<strong>ä½†æ˜¯å†…å­˜å­˜å‚¨çš„æ•°æ®ä¸æ˜¯æŒä¹…åŒ–çš„</strong>ï¼Œåœ¨ç¨‹åºå…³é—­åæ•°æ®å°±ä¼šä¸¢å¤±ã€‚</p>
<p>ä½¿ç”¨å†…å­˜å­˜å‚¨æ— éå°±æ˜¯ç”¨Goçš„æ•°æ®ç»“æ„ï¼Œå¦‚Arrayã€Sliceã€Mapç­‰ç»“æ„ï¼Œä¹Ÿå¯ä½¿æ˜¯æ‰©å±•çš„Stackã€Queueã€Treeç­‰ã€‚</p>
<p>åœ¨ä½¿ç”¨å†…å­˜å­˜å‚¨ï¼Œå°¤å…¶æ¶‰åŠåˆ°æ•°æ®ä¿®æ”¹çš„æ—¶å€™ï¼Œ<strong>è¦ç€é‡æ³¨æ„æ˜¯ä¼ é€’æŒ‡é’ˆå¼•ç”¨è¿˜æ˜¯ç›´æ¥ä¼ å€¼</strong>ã€‚</p>
<h3 id="csvcomma-separated-valueå­˜å‚¨">CSVï¼ˆcomma-separated valueï¼‰å­˜å‚¨</h3>
<p>ä¹Ÿå°±æ˜¯é€—å·åˆ†éš”ç¬¦å­˜å‚¨ï¼Œåƒè¿™æ ·ï¼š</p>
<p><img src="https://raw.githubusercontent.com/lizonglin313/MyPicGo/master/20211016151116.png"
	
	
	
	loading="lazy"
	
	
></p>
<p>ä½¿ç”¨CSVè¿›è¡Œå­˜å‚¨æ—¶ï¼Œéœ€è¦æŠŠæ•°æ®è½¬åŒ–æˆå­—ç¬¦ä¸²ï¼š</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span><span style="color:#a6e22e">writer</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">csv</span>.<span style="color:#a6e22e">NewWriter</span>(<span style="color:#a6e22e">csvFile</span>)
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">for</span> <span style="color:#a6e22e">_</span>, <span style="color:#a6e22e">post</span> <span style="color:#f92672">:=</span> <span style="color:#66d9ef">range</span> <span style="color:#a6e22e">allPosts</span> {
</span></span><span style="display:flex;"><span>   <span style="color:#a6e22e">line</span> <span style="color:#f92672">:=</span> []<span style="color:#66d9ef">string</span>{<span style="color:#a6e22e">strconv</span>.<span style="color:#a6e22e">Itoa</span>(<span style="color:#a6e22e">post</span>.<span style="color:#a6e22e">Id</span>), <span style="color:#a6e22e">post</span>.<span style="color:#a6e22e">Content</span>, <span style="color:#a6e22e">post</span>.<span style="color:#a6e22e">Author</span>}	<span style="color:#75715e">// è½¬æ¢æˆå­—ç¬¦ä¸²çš„åˆ‡ç‰‡
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>   <span style="color:#a6e22e">err</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">writer</span>.<span style="color:#a6e22e">Write</span>(<span style="color:#a6e22e">line</span>)	<span style="color:#75715e">// å®é™…ä¸Šå†™å…¥ä¸€ä¸ªbuffer
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>   <span style="color:#66d9ef">if</span> <span style="color:#a6e22e">err</span> <span style="color:#f92672">!=</span> <span style="color:#66d9ef">nil</span> {
</span></span><span style="display:flex;"><span>      panic(<span style="color:#a6e22e">err</span>)
</span></span><span style="display:flex;"><span>   }
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">writer</span>.<span style="color:#a6e22e">Flush</span>()	<span style="color:#75715e">// æœ€åå†å°†bufferå†™å…¥æ–‡ä»¶
</span></span></span></code></pre></div><h3 id="encodinggob">encoding/gob</h3>
<p>è¿™ä¸ªåŒ…ç”¨äºç®¡ç†gobç»„æˆçš„æµï¼Œè¿™æ˜¯ä¸€ç§åœ¨ç¼–ç å™¨å’Œè§£ç å™¨ä¹‹é—´è¿›è¡Œäº¤æµçš„ä¸€ç§äºŒè¿›åˆ¶æ•°æ®ã€‚</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span><span style="color:#66d9ef">func</span> <span style="color:#a6e22e">store</span>(<span style="color:#a6e22e">data</span> <span style="color:#66d9ef">interface</span>{}, <span style="color:#a6e22e">filename</span> <span style="color:#66d9ef">string</span>) {
</span></span><span style="display:flex;"><span>   <span style="color:#75715e">// åˆ›å»º ç¼“å†²åŒº
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>   <span style="color:#a6e22e">buffer</span> <span style="color:#f92672">:=</span> new(<span style="color:#a6e22e">bytes</span>.<span style="color:#a6e22e">Buffer</span>)
</span></span><span style="display:flex;"><span>   <span style="color:#75715e">// åˆ›å»º ç¼–ç å™¨ å‘ç¼“å†²åŒºå†™
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>   <span style="color:#a6e22e">encoder</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">gob</span>.<span style="color:#a6e22e">NewEncoder</span>(<span style="color:#a6e22e">buffer</span>)
</span></span><span style="display:flex;"><span>   <span style="color:#75715e">// ç¼–ç æ•°æ® å†™é“ ç¼“å†²åŒº data -&gt; buffer
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>   <span style="color:#a6e22e">err</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">encoder</span>.<span style="color:#a6e22e">Encode</span>(<span style="color:#a6e22e">data</span>)
</span></span><span style="display:flex;"><span>   <span style="color:#66d9ef">if</span> <span style="color:#a6e22e">err</span> <span style="color:#f92672">!=</span> <span style="color:#66d9ef">nil</span> {
</span></span><span style="display:flex;"><span>      panic(<span style="color:#a6e22e">err</span>)
</span></span><span style="display:flex;"><span>   }
</span></span><span style="display:flex;"><span>   <span style="color:#75715e">// å°† ç¼“å†²åŒºæ•°æ® å†™åˆ° æ–‡ä»¶
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>   <span style="color:#a6e22e">err</span> = <span style="color:#a6e22e">ioutil</span>.<span style="color:#a6e22e">WriteFile</span>(<span style="color:#a6e22e">filename</span>, <span style="color:#a6e22e">buffer</span>.<span style="color:#a6e22e">Bytes</span>(), <span style="color:#ae81ff">0600</span>)
</span></span><span style="display:flex;"><span>   <span style="color:#66d9ef">if</span> <span style="color:#a6e22e">err</span> <span style="color:#f92672">!=</span> <span style="color:#66d9ef">nil</span> {
</span></span><span style="display:flex;"><span>      panic(<span style="color:#a6e22e">err</span>)
</span></span><span style="display:flex;"><span>   }
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">func</span> <span style="color:#a6e22e">load</span>(<span style="color:#a6e22e">data</span> <span style="color:#66d9ef">interface</span>{}, <span style="color:#a6e22e">filename</span> <span style="color:#66d9ef">string</span>) {
</span></span><span style="display:flex;"><span>   <span style="color:#75715e">// ä» æ–‡ä»¶ä¸­ è¯»å–åŸå§‹æ•°æ®
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>   <span style="color:#a6e22e">raw</span>, <span style="color:#a6e22e">err</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">ioutil</span>.<span style="color:#a6e22e">ReadFile</span>(<span style="color:#a6e22e">filename</span>)
</span></span><span style="display:flex;"><span>   <span style="color:#66d9ef">if</span> <span style="color:#a6e22e">err</span> <span style="color:#f92672">!=</span> <span style="color:#66d9ef">nil</span> {
</span></span><span style="display:flex;"><span>      panic(<span style="color:#a6e22e">err</span>)
</span></span><span style="display:flex;"><span>   }
</span></span><span style="display:flex;"><span>   <span style="color:#75715e">// åˆ›å»ºç¼“å†²åŒº å°†åŸå§‹æ•°æ®å†™åˆ°ç¼“å†²åŒº raw -&gt; buffer
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>   <span style="color:#a6e22e">buffer</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">bytes</span>.<span style="color:#a6e22e">NewBuffer</span>(<span style="color:#a6e22e">raw</span>)
</span></span><span style="display:flex;"><span>   <span style="color:#75715e">// ä¸º ç¼“å†²åŒº åˆ›å»º è§£ç å™¨
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>   <span style="color:#a6e22e">dec</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">gob</span>.<span style="color:#a6e22e">NewDecoder</span>(<span style="color:#a6e22e">buffer</span>)
</span></span><span style="display:flex;"><span>   <span style="color:#a6e22e">err</span> = <span style="color:#a6e22e">dec</span>.<span style="color:#a6e22e">Decode</span>(<span style="color:#a6e22e">data</span>)
</span></span><span style="display:flex;"><span>   <span style="color:#66d9ef">if</span> <span style="color:#a6e22e">err</span> <span style="color:#f92672">!=</span> <span style="color:#66d9ef">nil</span> {
</span></span><span style="display:flex;"><span>      panic(<span style="color:#a6e22e">err</span>)
</span></span><span style="display:flex;"><span>   }
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><h3 id="æ•°æ®åº“ä¸å…³ç³»æ˜ å°„å™¨orm">æ•°æ®åº“ä¸å…³ç³»æ˜ å°„å™¨ORM</h3>
<p>Goå¯¹èƒ½è§åˆ°çš„å¸¸ç”¨çš„æ•°æ®åº“å‡ ä¹éƒ½æ”¯æŒï¼Œå¹¶ä¸”æœ‰Gormæ”¯æŒã€‚</p>
<p>Gormå…è®¸å®šä¹‰å…³ç³»ã€å®æ–½æ•°æ®è¿ç§»ã€ä¸²è”å¤šä¸ªæŸ¥è¯¢ä»¥åŠæ‰§è¡Œå…¶ä»–çš„å¾ˆå¤šé«˜çº§æ“ä½œï¼Œè¿˜å¯ä»¥è®¾ç½®å›è°ƒå‡½æ•°ç­‰ã€‚</p>
<blockquote>
<p>GORMä¸­æ–‡æ–‡æ¡£ï¼š</p>
<p><a class="link" href="https://gorm.io/zh_CN/docs/"  target="_blank" rel="noopener"
    >GORM æŒ‡å— | GORM - The fantastic ORM library for Golang, aims to be developer friendly.</a></p>
</blockquote>
<h2 id="7-å‘æŒ¥goçš„å¹¶å‘ä¼˜åŠ¿">7. å‘æŒ¥Goçš„å¹¶å‘ä¼˜åŠ¿</h2>
<p>è¿™éƒ¨åˆ†å†…å®¹ä¼šæ›´æ–°åˆ°æˆ‘ä¹‹å‰å†™çš„Goå¹¶å‘çš„åšæ–‡ä¸­ã€‚</p>
<p><a class="link" href="https://lizonglin313.github.io/post/goroutine-ren-wu-kong-zhi/"  target="_blank" rel="noopener"
    >Goçš„å¹¶å‘ä¸ä»»åŠ¡æ§åˆ¶ - Big Carrot (lizonglin313.github.io)</a></p>

</section>


    <footer class="article-footer">
    
    <section class="article-tags">
        
            <a href="/tags/golang/">Golang</a>
        
            <a href="/tags/web/">Web</a>
        
    </section>


    
    <section class="article-copyright">
        <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-copyright" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="12" cy="12" r="9" />
  <path d="M14.5 9a3.5 4 0 1 0 0 6" />
</svg>



        <span>Licensed under CC BY-NC-SA 4.0</span>
    </section>
    <script src="https://utteranc.es/client.js"
    repo="lizonglingo/lizonglingo.github.io"
    issue-term="pathname"
    label="Comment"
    theme="github-light"
    crossorigin="anonymous"
    async>
    </script>
</footer>


    
        <link 
                rel="stylesheet" 
                href="https://cdn.jsdelivr.net/npm/katex@0.15.6/dist/katex.min.css"integrity="sha256-J&#43;iAE0sgH8QSz9hpcDxXIftnj65JEZgNhGcgReTTK9s="crossorigin="anonymous"
            ><script 
                src="https://cdn.jsdelivr.net/npm/katex@0.15.6/dist/katex.min.js"integrity="sha256-InsNdER1b2xUewP&#43;pKCUJpkhiqwHgqiPXDlIk7GzBu4="crossorigin="anonymous"
                defer
                >
            </script><script 
                src="https://cdn.jsdelivr.net/npm/katex@0.15.6/dist/contrib/auto-render.min.js"integrity="sha256-y39Mpg7V3D4lhBX4x6O0bUqTV4pSrfgwEfGKfxkOdgI="crossorigin="anonymous"
                defer
                >
            </script><script>
    window.addEventListener("DOMContentLoaded", () => {
        renderMathInElement(document.querySelector(`.article-content`), {
            delimiters: [
                { left: "$$", right: "$$", display: true },
                { left: "$", right: "$", display: false },
                { left: "\\(", right: "\\)", display: false },
                { left: "\\[", right: "\\]", display: true }
            ]
        });})
</script>
    

</article>

    

    

<aside class="related-content--wrapper">
    <h2 class="section-title">ç›¸å…³æ–‡ç« </h2>
    <div class="related-content">
        <div class="flex article-list--tile">
            
                
<article class="">
    <a href="/p/go%E7%9A%84%E5%8C%BF%E5%90%8D%E5%87%BD%E6%95%B0%E9%97%AD%E5%8C%85/">
        
        

        <div class="article-details">
            <h2 class="article-title">Goçš„åŒ¿åå‡½æ•°(é—­åŒ…)</h2>
        </div>
    </a>
</article>

            
                
<article class="">
    <a href="/p/go-web%E5%9F%BA%E7%A1%80/">
        
        

        <div class="article-details">
            <h2 class="article-title">Go WebåŸºç¡€</h2>
        </div>
    </a>
</article>

            
                
<article class="">
    <a href="/p/%E5%85%B3%E4%BA%8Ehandlehandlefunchandler%E5%92%8Chandlerfunc/">
        
        

        <div class="article-details">
            <h2 class="article-title">å…³äºHandleã€HandleFuncã€Handlerå’ŒHandlerFunc</h2>
        </div>
    </a>
</article>

            
                
<article class="">
    <a href="/p/golang-jsonrpc-demo/">
        
        

        <div class="article-details">
            <h2 class="article-title">Golang Jsonrpc Demo</h2>
        </div>
    </a>
</article>

            
                
<article class="">
    <a href="/p/golang%E6%8E%A5%E5%8F%A3/">
        
        

        <div class="article-details">
            <h2 class="article-title">Golangæ¥å£</h2>
        </div>
    </a>
</article>

            
        </div>
    </div>
</aside>

     
    
        
    

    <footer class="site-footer">
    <section class="copyright">
        &copy; 
        
            2018 - 
        
        2023 fmt.Println(&#34;Li Duo&#34;)
    </section>
    
    <section class="powerby">
        
            è‡ªè®¤ä¸ºæ˜¯å¹»è±¡æ³¢æ™®æ˜Ÿçš„æ¥å®¢ <br/>
        Built with <a href="https://gohugo.io/" target="_blank" rel="noopener">Hugo</a> <br />
        ä¸»é¢˜ <b><a href="https://github.com/CaiJimmy/hugo-theme-stack" target="_blank" rel="noopener" data-version="3.16.0">Stack</a></b> ç”± <a href="https://jimmycai.com" target="_blank" rel="noopener">Jimmy</a> è®¾è®¡
    </section>
</footer>


    
<div class="pswp" tabindex="-1" role="dialog" aria-hidden="true">

    
    <div class="pswp__bg"></div>

    
    <div class="pswp__scroll-wrap">

        
        <div class="pswp__container">
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
        </div>

        
        <div class="pswp__ui pswp__ui--hidden">

            <div class="pswp__top-bar">

                

                <div class="pswp__counter"></div>

                <button class="pswp__button pswp__button--close" title="Close (Esc)"></button>

                <button class="pswp__button pswp__button--share" title="Share"></button>

                <button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>

                <button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button>

                
                
                <div class="pswp__preloader">
                    <div class="pswp__preloader__icn">
                        <div class="pswp__preloader__cut">
                            <div class="pswp__preloader__donut"></div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap">
                <div class="pswp__share-tooltip"></div>
            </div>

            <button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
            </button>

            <button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)">
            </button>

            <div class="pswp__caption">
                <div class="pswp__caption__center"></div>
            </div>

        </div>

    </div>

</div><script 
                src="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.js"integrity="sha256-ePwmChbbvXbsO02lbM3HoHbSHTHFAeChekF1xKJdleo="crossorigin="anonymous"
                defer
                >
            </script><script 
                src="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe-ui-default.min.js"integrity="sha256-UKkzOn/w1mBxRmLLGrSeyB4e1xbrp4xylgAWb3M42pU="crossorigin="anonymous"
                defer
                >
            </script><link 
                rel="stylesheet" 
                href="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/default-skin/default-skin.min.css"crossorigin="anonymous"
            ><link 
                rel="stylesheet" 
                href="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.css"crossorigin="anonymous"
            >

            </main>
        </div>
        <script 
                src="https://cdn.jsdelivr.net/npm/node-vibrant@3.1.6/dist/vibrant.min.js"integrity="sha256-awcR2jno4kI5X0zL8ex0vi2z&#43;KMkF24hUW8WePSA9HM="crossorigin="anonymous"
                
                >
            </script><script type="text/javascript" src="/ts/main.js" defer></script>
<script>
    (function () {
        const customFont = document.createElement('link');
        customFont.href = "https://fonts.googleapis.com/css2?family=Lato:wght@300;400;700&display=swap";

        customFont.type = "text/css";
        customFont.rel = "stylesheet";

        document.head.appendChild(customFont);
    }());
</script>

    </body>
</html>
